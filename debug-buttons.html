<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Debug Buttons Test</title>
</head>
<body>
    <h1>Button Functionality Debug Test</h1>
    
    <button onclick="testFunction1()">Test Button 1 (Basic JS)</button><br><br>
    <button onclick="testFunction2()">Test Button 2 (Firebase Test)</button><br><br>
    <button onclick="loadMainAppScript()">Test Button 3 (Load Main App Script)</button><br><br>
    
    <div id="output" style="border: 1px solid #ccc; padding: 10px; margin-top: 20px; min-height: 100px;">
        <p>Click buttons to test functionality...</p>
    </div>

    <!-- Load Firebase SDK like the main app -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Basic JavaScript test
        function testFunction1() {
            document.getElementById('output').innerHTML += '<p style="color: green;">✅ Basic JavaScript working!</p>';
            console.log('Basic JavaScript function executed');
        }
        
        // Firebase availability test
        function testFunction2() {
            const output = document.getElementById('output');
            
            // More detailed Firebase testing
            output.innerHTML += '<h3>Detailed Firebase Debug:</h3>';
            
            // Test if firebase exists
            if (typeof firebase !== 'undefined') {
                output.innerHTML += '<p style="color: green;">✅ Firebase object available!</p>';
                console.log('Firebase object found:', firebase);
                
                // Test Firebase properties
                if (firebase.initializeApp) {
                    output.innerHTML += '<p style="color: green;">✅ firebase.initializeApp exists</p>';
                } else {
                    output.innerHTML += '<p style="color: red;">❌ firebase.initializeApp missing</p>';
                }
                
                if (firebase.auth) {
                    output.innerHTML += '<p style="color: green;">✅ firebase.auth exists</p>';
                } else {
                    output.innerHTML += '<p style="color: red;">❌ firebase.auth missing</p>';
                }
                
                // Try to initialize Firebase
                try {
                    const config = {
                        apiKey: "test-key",
                        authDomain: "test.firebaseapp.com",
                        projectId: "test"
                    };
                    const app = firebase.initializeApp(config, 'test-app');
                    output.innerHTML += '<p style="color: green;">✅ Firebase can initialize apps</p>';
                } catch (error) {
                    output.innerHTML += '<p style="color: orange;">⚠️ Firebase init test failed: ' + error.message + '</p>';
                }
                
            } else {
                output.innerHTML += '<p style="color: red;">❌ Firebase object NOT available!</p>';
                console.log('Firebase object not found');
                
                // Check if scripts loaded
                const scripts = document.querySelectorAll('script[src*="firebase"]');
                if (scripts.length > 0) {
                    output.innerHTML += '<p style="color: orange;">⚠️ Firebase script tags found (' + scripts.length + ') but Firebase object missing</p>';
                    scripts.forEach((script, i) => {
                        output.innerHTML += '<p style="font-size: 12px;">Script ' + (i+1) + ': ' + script.src + '</p>';
                    });
                } else {
                    output.innerHTML += '<p style="color: red;">❌ No Firebase script tags found</p>';
                }
            }
            
            // Test if authentication functions exist
            const authFunctions = ['createAccountWithFirebase', 'signInWithFirebase', 'logout', 'showTab'];
            authFunctions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    output.innerHTML += '<p style="color: green;">✅ ' + funcName + ' function exists!</p>';
                } else {
                    output.innerHTML += '<p style="color: red;">❌ ' + funcName + ' function NOT found!</p>';
                }
            });
        }
        
        // Test loading the main app script to see if there are errors
        function loadMainAppScript() {
            const output = document.getElementById('output');
            output.innerHTML += '<h3>Loading Main App Script...</h3>';
            
            // Track JavaScript errors
            const originalErrors = [];
            window.addEventListener('error', function(e) {
                originalErrors.push(e.message);
                output.innerHTML += '<p style="color: red;">❌ JS Error: ' + e.message + '</p>';
                output.innerHTML += '<p style="font-size: 12px;">File: ' + e.filename + ', Line: ' + e.lineno + '</p>';
            });
            
            // Load the main app script dynamically
            const script = document.createElement('script');
            script.onload = function() {
                output.innerHTML += '<p style="color: green;">✅ Main app script loaded successfully</p>';
                
                // Test if functions are now available
                const authFunctions = ['createAccountWithFirebase', 'signInWithFirebase', 'logout', 'showTab'];
                authFunctions.forEach(funcName => {
                    if (typeof window[funcName] === 'function') {
                        output.innerHTML += '<p style="color: green;">✅ ' + funcName + ' function NOW exists!</p>';
                    } else {
                        output.innerHTML += '<p style="color: red;">❌ ' + funcName + ' function STILL NOT found!</p>';
                    }
                });
            };
            
            script.onerror = function() {
                output.innerHTML += '<p style="color: red;">❌ Failed to load main app script</p>';
            };
            
            // Extract the script content from the main app (simplified version)
            script.innerHTML = `
                console.log('Testing function definitions...');
                
                // Simple test functions
                window.createAccountWithFirebase = function() {
                    alert('createAccountWithFirebase called!');
                };
                
                window.signInWithFirebase = function() {
                    alert('signInWithFirebase called!');
                };
                
                window.logout = function() {
                    alert('logout called!');
                };
                
                window.showTab = function(tab) {
                    alert('showTab called with: ' + tab);
                };
                
                console.log('Test functions defined');
            `;
            
            document.head.appendChild(script);
        }
        
        // Wait for Firebase to load then test
        setTimeout(() => {
            console.log('Firebase availability after delay:', typeof firebase !== 'undefined');
        }, 2000);
        
        console.log('Debug script loaded');
    </script>
</body>
</html>