<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Kinben KPN System Master Workbook</title>
    <style>
        body { font-family: Calibri, Arial, sans-serif; margin: 0; }
        .workbook-container { padding: 20px; }
        .sheet-tabs { border-bottom: 2px solid #0078d4; margin-bottom: 20px; overflow-x: auto; white-space: nowrap; }
        .tab { display: inline-block; padding: 10px 20px; margin-right: 5px; background: #f5f5f5; border: 1px solid #ccc; cursor: pointer; border-radius: 5px 5px 0 0; transition: all 0.3s; }
        .tab:hover { background: #e3f2fd; }
        .tab.active { background: #0078d4; color: white; border-bottom: 2px solid #0078d4; }
        .sheet { display: none; }
        .sheet.active { display: block; }
        
        /* Enhanced Landing Page */
        .landing-page { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 10px; margin-bottom: 30px; }
        .landing-title { font-size: 32px; font-weight: bold; text-align: center; margin-bottom: 20px; }
        .landing-subtitle { font-size: 18px; text-align: center; margin-bottom: 30px; opacity: 0.9; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .info-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; }
        .info-card h3 { margin-top: 0; color: #fff; }
        .naming-convention { background: rgba(255,255,255,0.15); padding: 20px; border-radius: 8px; margin: 20px 0; }
        
        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .stat-number { font-size: 32px; font-weight: bold; color: #0078d4; }
        .stat-label { color: #666; font-size: 14px; margin-top: 5px; }
        
        /* Action Buttons */
        .action-buttons { display: flex; gap: 15px; margin: 20px 0; flex-wrap: wrap; }
        .btn { padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; text-decoration: none; display: inline-block; transition: all 0.3s; }
        .btn-primary { background: #0078d4; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-info { background: #17a2b8; color: white; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        
        /* Search and Filter */
        .search-controls { background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .search-input { width: 300px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px; }
        .filter-select { padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px; }
        
        /* Tables */
        .category-table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .category-table th { background: #0078d4; color: white; padding: 12px; text-align: left; font-weight: bold; }
        .category-table td { padding: 10px 12px; border-bottom: 1px solid #eee; }
        .category-table tr:nth-child(even) { background: #f9f9f9; }
        .category-table tr:hover { background: #e3f2fd; }
        .component-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 10px; }
        .component-table th { background: #2c5aa0; color: white; padding: 8px; text-align: left; font-weight: bold; position: sticky; top: 0; }
        .component-table td { padding: 6px 8px; border-bottom: 1px solid #ddd; white-space: nowrap; }
        .component-table tr:nth-child(even) { background: #f8f9fa; }
        .component-table tr:hover { background: #e3f2fd; }
        
        /* Status indicators */
        .status-active { color: #28a745; font-weight: bold; }
        .status-pending { color: #ffc107; font-weight: bold; }
        .status-obsolete { color: #dc3545; font-weight: bold; }
        
        /* Section headers */
        .section-header { background: #f1f3f4; padding: 15px; margin: 20px 0 10px 0; border-left: 4px solid #0078d4; font-weight: bold; border-radius: 0 8px 8px 0; }
        
        /* Add Component Form */
        .add-component-form { background: #f8f9fa; padding: 30px; border-radius: 10px; margin: 20px 0; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { margin-bottom: 5px; font-weight: bold; color: #333; }
        .form-group input, .form-group select, .form-group textarea { padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .form-group textarea { resize: vertical; min-height: 80px; }
        
        /* Modal styles */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 30px; border-radius: 10px; width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: #000; }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .action-buttons { flex-direction: column; }
            .info-grid { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .search-input { width: 100%; margin-bottom: 10px; }
            .sheet-tabs { padding-bottom: 10px; }
        }
        
        /* Export styles */
        .export-options { background: white; padding: 20px; border-radius: 8px; margin: 10px 0; }
        .export-button { margin: 5px; }
        
        /* Search Results styles */
        .search-results-header { display: flex; justify-content: between; align-items: center; margin-bottom: 20px; }
        .search-results-info { flex: 1; }
        .search-results-actions { display: flex; gap: 10px; }
        .search-results-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .search-results-table th { background: #28a745; color: white; padding: 12px; text-align: left; font-weight: bold; }
        .search-results-table td { padding: 10px 12px; border-bottom: 1px solid #ddd; }
        .search-results-table tr:nth-child(even) { background: #f8f9fa; }
        .search-results-table tr:hover { background: #e3f2fd; }
        .category-badge { background: #007bff; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        .search-highlight { background-color: #ffeb3b; font-weight: bold; }
        mark { background-color: #ffeb3b; padding: 1px 2px; border-radius: 2px; }
        
        /* Real-time search */
        .search-input-container { position: relative; display: inline-block; }
        .search-suggestions { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); z-index: 100; max-height: 200px; overflow-y: auto; display: none; }
        .search-suggestion-item { padding: 10px; cursor: pointer; border-bottom: 1px solid #eee; }
        .search-suggestion-item:hover { background: #f0f0f0; }
        .search-suggestion-item:last-child { border-bottom: none; }
    </style>
    <script>
        // Component data storage
        let componentData = {
            capacitors: [], resistors: [], inductors: [], diodes: [], transistors: [],
            ics: [], connectors: [], crystals: [], fuses: [], switches: [],
            relays: [], optocouplers: [], sensors: [], mechanical: [], hardware: [], cables: []
        };
        
        // Category configurations
        const categoryConfigs = {
            capacitors: { code: 'CAP', subcategories: ['CER', 'ELE', 'TAN', 'FIL'] },
            resistors: { code: 'RES', subcategories: ['STD', 'PRE', 'VAR', 'NET'] },
            inductors: { code: 'IND', subcategories: ['PWR', 'CHK', 'FER'] },
            diodes: { code: 'DIO', subcategories: ['STD', 'LED', 'ZEN', 'SCH'] },
            transistors: { code: 'TRA', subcategories: ['BJT', 'FET', 'MOS'] },
            ics: { code: 'IC', subcategories: ['MCU', 'ANA', 'DIG', 'PWR'] },
            connectors: { code: 'CON', subcategories: ['HDR', 'JST', 'USB', 'RJ45'] },
            crystals: { code: 'CRY', subcategories: ['XTL', 'OSC', 'RES'] },
            fuses: { code: 'FUS', subcategories: ['STD', 'RST', 'PTC'] },
            switches: { code: 'SWI', subcategories: ['TAC', 'DIP', 'ROT', 'SLI'] },
            relays: { code: 'REL', subcategories: ['EMR', 'SSR'] },
            optocouplers: { code: 'OPT', subcategories: ['STD', 'HIS', 'DAR'] },
            sensors: { code: 'SEN', subcategories: ['TMP', 'PRE', 'ACC', 'GYR'] },
            mechanical: { code: 'MEC', subcategories: ['ENC', 'FAN', 'HEA', 'SPK'] },
            hardware: { code: 'HWR', subcategories: ['SCR', 'NUT', 'WSH', 'SPC'] },
            cables: { code: 'CBL', subcategories: ['PWR', 'SIG', 'COA', 'FFC'] }
        };

        function showSheet(sheetName) {
            // Hide all sheets
            const sheets = document.querySelectorAll('.sheet');
            sheets.forEach(sheet => sheet.classList.remove('active'));
            
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected sheet and tab
            document.getElementById(sheetName).classList.add('active');
            event.target.classList.add('active');
            
            // Update component counts and refresh tables
            updateStats();
            if (sheetName !== 'landing') {
                refreshComponentTable(sheetName);
            }
        }
        
        function updateStats() {
            let totalComponents = 0;
            let activeCategories = 0;
            
            Object.keys(componentData).forEach(category => {
                const count = componentData[category].length;
                totalComponents += count;
                if (count > 0) activeCategories++;
                
                // Update category table counts
                const categoryRow = document.querySelector(`[data-category="${category}"]`);
                if (categoryRow) {
                    categoryRow.querySelector('.count-cell').textContent = count;
                }
            });
            
            // Update stats cards
            document.getElementById('total-components').textContent = totalComponents;
            document.getElementById('active-categories').textContent = activeCategories;
            document.getElementById('total-categories').textContent = Object.keys(componentData).length;
        }
        
        function generateKPN(category, subcategory) {
            const categoryData = componentData[category] || [];
            const categoryCode = categoryConfigs[category].code;
            const sequence = (categoryData.length + 1).toString().padStart(4, '0');
            return `KPN-${categoryCode}-${subcategory}-${sequence}`;
        }
        
        function openAddComponentModal(category) {
            const modal = document.getElementById('addComponentModal');
            const form = document.getElementById('addComponentForm');
            const categorySelect = document.getElementById('categorySelect');
            const subcategorySelect = document.getElementById('subcategorySelect');
            
            // Set category
            categorySelect.value = category;
            updateSubcategories();
            
            // Show modal
            modal.style.display = 'block';
        }
        
        function closeAddComponentModal() {
            document.getElementById('addComponentModal').style.display = 'none';
        }
        
        function updateSubcategories() {
            const categorySelect = document.getElementById('categorySelect');
            const subcategorySelect = document.getElementById('subcategorySelect');
            const category = categorySelect.value;
            
            subcategorySelect.innerHTML = '<option value="">Select Subcategory</option>';
            
            if (category && categoryConfigs[category]) {
                categoryConfigs[category].subcategories.forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subcategorySelect.appendChild(option);
                });
            }
        }
        
        function generateKPNPreview() {
            const category = document.getElementById('categorySelect').value;
            const subcategory = document.getElementById('subcategorySelect').value;
            const preview = document.getElementById('kpnPreview');
            
            if (category && subcategory) {
                const kpn = generateKPN(category, subcategory);
                preview.textContent = kpn;
                document.getElementById('kinbenPN').value = kpn;
            } else {
                preview.textContent = 'Select category and subcategory';
                document.getElementById('kinbenPN').value = '';
            }
        }
        
        function addComponent() {
            const form = document.getElementById('addComponentForm');
            const formData = new FormData(form);
            const category = formData.get('category');
            
            if (!category) {
                alert('Please select a category');
                return;
            }
            
            // Create component object
            const component = {
                kinbenPN: formData.get('kinbenPN'),
                value: formData.get('value'),
                voltage: formData.get('voltage'),
                current: formData.get('current'),
                power: formData.get('power'),
                tolerance: formData.get('tolerance'),
                package: formData.get('package'),
                mounting: formData.get('mounting'),
                temperature: formData.get('temperature'),
                manufacturer: formData.get('manufacturer'),
                manufacturerPN: formData.get('manufacturerPN'),
                description: formData.get('description'),
                supplier: formData.get('supplier'),
                mouserPN: formData.get('mouserPN'),
                digikeyPN: formData.get('digikeyPN'),
                cost: formData.get('cost'),
                moq: formData.get('moq'),
                status: formData.get('status') || 'Active',
                symbolFile: formData.get('symbolFile'),
                footprintFile: formData.get('footprintFile'),
                modelFile: formData.get('modelFile'),
                notes: formData.get('notes'),
                createdDate: new Date().toISOString().split('T')[0],
                createdBy: 'User'
            };
            
            // Add to component data
            if (!componentData[category]) {
                componentData[category] = [];
            }
            componentData[category].push(component);
            
            // Close modal and refresh
            closeAddComponentModal();
            form.reset();
            updateStats();
            
            // If we're on the category sheet, refresh it
            const activeSheet = document.querySelector('.sheet.active');
            if (activeSheet && activeSheet.id === category) {
                refreshComponentTable(category);
            }
            
            alert('Component added successfully!');
        }
        
        function refreshComponentTable(category) {
            const table = document.querySelector(`#${category} .component-table tbody`);
            if (!table) return;
            
            const components = componentData[category] || [];
            
            if (components.length === 0) {
                table.innerHTML = '<tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Component" to get started!</td></tr>';
                return;
            }
            
            table.innerHTML = '';
            components.forEach(component => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${component.kinbenPN}</td>
                    <td>${component.value || '-'}</td>
                    <td>${component.voltage || '-'}</td>
                    <td>${component.tolerance || '-'}</td>
                    <td>${component.package || '-'}</td>
                    <td>${component.mounting || '-'}</td>
                    <td>${component.temperature || '-'}</td>
                    <td>${component.manufacturer || '-'}</td>
                    <td>${component.manufacturerPN || '-'}</td>
                    <td>${component.description || '-'}</td>
                    <td>${component.supplier || '-'}</td>
                    <td>${component.mouserPN || '-'}</td>
                    <td>${component.digikeyPN || '-'}</td>
                    <td>${component.cost || '-'}</td>
                    <td>${component.moq || '-'}</td>
                    <td><span class="status-${component.status.toLowerCase()}">${component.status}</span></td>
                    <td>${component.symbolFile || '-'}</td>
                    <td>${component.footprintFile || '-'}</td>
                    <td>${component.modelFile || '-'}</td>
                    <td>${component.notes || '-'}</td>
                `;
                table.appendChild(row);
            });
        }
        
        function exportData(format, category = null) {
            let data = category ? componentData[category] : componentData;
            let filename = category ? `${category}_components` : 'all_components';
            
            if (format === 'csv') {
                exportToCSV(data, filename);
            } else if (format === 'json') {
                exportToJSON(data, filename);
            }
        }
        
        function exportToCSV(data, filename) {
            if (!data || (Array.isArray(data) && data.length === 0)) {
                alert('No data to export');
                return;
            }
            
            let csvContent = '';
            let components = Array.isArray(data) ? data : Object.values(data).flat();
            
            if (components.length === 0) {
                alert('No components to export');
                return;
            }
            
            // Headers
            const headers = Object.keys(components[0]);
            csvContent += headers.join(',') + '\\n';
            
            // Data rows
            components.forEach(component => {
                const row = headers.map(header => {
                    const value = component[header] || '';
                    return `"${value.toString().replace(/"/g, '""')}"`;
                });
                csvContent += row.join(',') + '\\n';
            });
            
            downloadFile(csvContent, `${filename}.csv`, 'text/csv');
        }
        
        function exportToJSON(data, filename) {
            const jsonContent = JSON.stringify(data, null, 2);
            downloadFile(jsonContent, `${filename}.json`, 'application/json');
        }
        
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
        
        function searchComponents() {
            const searchTerm = document.getElementById('globalSearch').value.toLowerCase().trim();
            const categoryFilter = document.getElementById('categoryFilter').value;
            
            if (!searchTerm) {
                alert('Please enter a search term');
                return;
            }
            
            // Search across all components or specific category
            let searchResults = [];
            const categoriesToSearch = categoryFilter ? [categoryFilter] : Object.keys(componentData);
            
            categoriesToSearch.forEach(category => {
                const components = componentData[category] || [];
                components.forEach(component => {
                    // Search in all text fields of the component
                    const searchableText = [
                        component.kinbenPN, component.value, component.voltage, component.current, 
                        component.power, component.tolerance, component.package, component.mounting,
                        component.temperature, component.manufacturer, component.manufacturerPN,
                        component.description, component.supplier, component.mouserPN, 
                        component.digikeyPN, component.status, component.notes
                    ].join(' ').toLowerCase();
                    
                    if (searchableText.includes(searchTerm)) {
                        searchResults.push({
                            ...component,
                            category: category,
                            categoryName: getCategoryDisplayName(category)
                        });
                    }
                });
            });
            
            displaySearchResults(searchResults, searchTerm);
        }
        
        function getCategoryDisplayName(category) {
            const categoryNames = {
                capacitors: 'Capacitors', resistors: 'Resistors', inductors: 'Inductors',
                diodes: 'Diodes', transistors: 'Transistors', ics: 'Integrated Circuits',
                connectors: 'Connectors', crystals: 'Crystals & Oscillators', fuses: 'Fuses',
                switches: 'Switches', relays: 'Relays', optocouplers: 'Optocouplers',
                sensors: 'Sensors', mechanical: 'Mechanical', hardware: 'Hardware',
                cables: 'Cables & Wires'
            };
            return categoryNames[category] || category;
        }
        
        function displaySearchResults(results, searchTerm) {
            // Show search results sheet
            showSearchResults();
            
            // Update search results table
            const tbody = document.querySelector('#search-results .search-results-table tbody');
            const resultsCount = document.getElementById('search-results-count');
            const searchTermDisplay = document.getElementById('search-term-display');
            
            resultsCount.textContent = results.length;
            searchTermDisplay.textContent = searchTerm;
            
            if (results.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; color: #666; padding: 20px;">No components found matching your search.</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            results.forEach(component => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${component.kinbenPN}</strong></td>
                    <td><span class="category-badge">${component.categoryName}</span></td>
                    <td>${highlightSearchTerm(component.value || '-', searchTerm)}</td>
                    <td>${highlightSearchTerm(component.manufacturer || '-', searchTerm)}</td>
                    <td>${highlightSearchTerm(component.manufacturerPN || '-', searchTerm)}</td>
                    <td>${highlightSearchTerm(component.description || '-', searchTerm)}</td>
                    <td><span class="status-${component.status.toLowerCase()}">${component.status}</span></td>
                    <td><button class="btn btn-primary btn-sm" onclick="viewComponent('${component.category}', '${component.kinbenPN}')">View</button></td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function highlightSearchTerm(text, searchTerm) {
            if (!text || !searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }
        
        function showSearchResults() {
            // Hide all sheets
            const sheets = document.querySelectorAll('.sheet');
            sheets.forEach(sheet => sheet.classList.remove('active'));
            
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show search results sheet
            document.getElementById('search-results').classList.add('active');
            
            // Highlight search tab if it exists, otherwise create visual indicator
            const searchTab = document.querySelector('[onclick="showSheet(\'search-results\')"]');
            if (searchTab) {
                searchTab.classList.add('active');
            }
        }
        
        function viewComponent(category, kinbenPN) {
            // Switch to the category sheet and highlight the component
            showSheet(category);
            
            // Find and highlight the component in the table
            setTimeout(() => {
                const table = document.querySelector(`#${category} .component-table`);
                if (table) {
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => {
                        const firstCell = row.querySelector('td');
                        if (firstCell && firstCell.textContent === kinbenPN) {
                            row.style.backgroundColor = '#fff3cd';
                            row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            
                            // Remove highlight after 3 seconds
                            setTimeout(() => {
                                row.style.backgroundColor = '';
                            }, 3000);
                        }
                    });
                }
            }, 100);
        }
        
        function clearSearch() {
            document.getElementById('globalSearch').value = '';
            document.getElementById('categoryFilter').value = '';
            showSheet('landing');
        }
        
        // Initialize on page load
        window.addEventListener('load', function() {
            updateStats();
            
            // Add event listeners
            document.getElementById('categorySelect').addEventListener('change', updateSubcategories);
            document.getElementById('subcategorySelect').addEventListener('change', generateKPNPreview);
            
            // Add Enter key support for search
            document.getElementById('globalSearch').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchComponents();
                }
            });
            
            // Close modal when clicking outside
            document.getElementById('addComponentModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAddComponentModal();
                }
            });
        });
    </script>
</head>
<body>
    <div class="workbook-container">
        <div class="sheet-tabs">
            <div class="tab active" onclick="showSheet('landing')">📊 Dashboard</div>
            <div class="tab" onclick="showSheet('add-component')">➕ Add Component</div>
            <div class="tab" onclick="showSheet('capacitors')">🔋 CAPACITORS</div>
            <div class="tab" onclick="showSheet('resistors')">⚡ RESISTORS</div>
            <div class="tab" onclick="showSheet('inductors')">🌀 INDUCTORS</div>
            <div class="tab" onclick="showSheet('diodes')">💡 DIODES</div>
            <div class="tab" onclick="showSheet('transistors')">🔧 TRANSISTORS</div>
            <div class="tab" onclick="showSheet('ics')">🖥️ ICs</div>
            <div class="tab" onclick="showSheet('connectors')">🔌 CONNECTORS</div>
            <div class="tab" onclick="showSheet('crystals')">🔮 CRYSTALS</div>
            <div class="tab" onclick="showSheet('fuses')">🛡️ FUSES</div>
            <div class="tab" onclick="showSheet('switches')">🔘 SWITCHES</div>
            <div class="tab" onclick="showSheet('relays')">🔄 RELAYS</div>
            <div class="tab" onclick="showSheet('optocouplers')">💡 OPTOCOUPLERS</div>
            <div class="tab" onclick="showSheet('sensors')">📡 SENSORS</div>
            <div class="tab" onclick="showSheet('mechanical')">⚙️ MECHANICAL</div>
            <div class="tab" onclick="showSheet('hardware')">🔩 HARDWARE</div>
            <div class="tab" onclick="showSheet('cables')">🔌 CABLES</div>
        </div>

        <!-- Enhanced Dashboard -->
        <div id="landing" class="sheet active">
            <div class="landing-page">
                <div class="landing-title">🔧 Kinben KPN System</div>
                <div class="landing-subtitle">Unified Parts Reference & Management System</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-components">0</div>
                        <div class="stat-label">Total Components</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="active-categories">0</div>
                        <div class="stat-label">Active Categories</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-categories">16</div>
                        <div class="stat-label">Total Categories</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">📈</div>
                        <div class="stat-label">Growing Daily</div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="showSheet('add-component')">➕ Add Component</button>
                    <button class="btn btn-success" onclick="exportData('csv')">📄 Export All CSV</button>
                    <button class="btn btn-info" onclick="exportData('json')">📊 Export JSON</button>
                    <button class="btn btn-warning" onclick="document.getElementById('globalSearch').focus()">🔍 Advanced Search</button>
                </div>
                
                <div class="info-grid">
                    <div class="info-card">
                        <h3>📋 System Purpose</h3>
                        <p>Centralized management of Kinben Part Numbers (KPNs) with standardized naming conventions, component specifications, and library references.</p>
                    </div>
                    <div class="info-card">
                        <h3>🎯 New Features</h3>
                        <ul>
                            <li>✅ Interactive component addition</li>
                            <li>✅ Real-time statistics</li>
                            <li>✅ Export functionality</li>
                            <li>✅ Auto KPN generation</li>
                            <li>✅ Mobile responsive design</li>
                        </ul>
                    </div>
                </div>
                
                <div class="naming-convention">
                    <h3>🏷️ KPN Naming Convention</h3>
                    <p><strong>Format:</strong> KPN-[CATEGORY]-[SUBCATEGORY]-[SEQUENCE]</p>
                    <p><strong>Example:</strong> KPN-CAP-CER-00001 (Ceramic Capacitor #1)</p>
                </div>
            </div>
            
            <!-- Global Search -->
            <div class="search-controls">
                <input type="text" id="globalSearch" class="search-input" placeholder="Search all components...">
                <select id="categoryFilter" class="filter-select">
                    <option value="">All Categories</option>
                    <option value="capacitors">Capacitors</option>
                    <option value="resistors">Resistors</option>
                    <option value="inductors">Inductors</option>
                    <option value="diodes">Diodes</option>
                    <option value="transistors">Transistors</option>
                    <option value="ics">Integrated Circuits</option>
                    <option value="connectors">Connectors</option>
                    <option value="crystals">Crystals & Oscillators</option>
                    <option value="fuses">Fuses</option>
                    <option value="switches">Switches</option>
                    <option value="relays">Relays</option>
                    <option value="optocouplers">Optocouplers</option>
                    <option value="sensors">Sensors</option>
                    <option value="mechanical">Mechanical</option>
                    <option value="hardware">Hardware</option>
                    <option value="cables">Cables & Wires</option>
                </select>
                <button class="btn btn-primary" onclick="searchComponents()">🔍 Search</button>
            </div>
            
            <div class="section-header">📊 Component Categories</div>
            <table class="category-table">
                <tr>
                    <th>Category Code</th>
                    <th>Category Name</th>
                    <th>Subcategories</th>
                    <th>Total Parts</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
                <tr data-category="capacitors">
                    <td>CAP</td><td>Capacitors</td><td>CER, ELE, TAN, FIL</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('capacitors')">Add</button></td>
                </tr>
                <tr data-category="resistors">
                    <td>RES</td><td>Resistors</td><td>STD, PRE, VAR, NET</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('resistors')">Add</button></td>
                </tr>
                <tr data-category="inductors">
                    <td>IND</td><td>Inductors</td><td>PWR, CHK, FER</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('inductors')">Add</button></td>
                </tr>
                <tr data-category="diodes">
                    <td>DIO</td><td>Diodes</td><td>STD, LED, ZEN, SCH</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('diodes')">Add</button></td>
                </tr>
                <tr data-category="transistors">
                    <td>TRA</td><td>Transistors</td><td>BJT, FET, MOS</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('transistors')">Add</button></td>
                </tr>
                <tr data-category="ics">
                    <td>IC</td><td>Integrated Circuits</td><td>MCU, ANA, DIG, PWR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('ics')">Add</button></td>
                </tr>
                <tr data-category="connectors">
                    <td>CON</td><td>Connectors</td><td>HDR, JST, USB, RJ45</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('connectors')">Add</button></td>
                </tr>
                <tr data-category="crystals">
                    <td>CRY</td><td>Crystals & Oscillators</td><td>XTL, OSC, RES</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('crystals')">Add</button></td>
                </tr>
                <tr data-category="fuses">
                    <td>FUS</td><td>Fuses</td><td>STD, RST, PTC</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('fuses')">Add</button></td>
                </tr>
                <tr data-category="switches">
                    <td>SWI</td><td>Switches</td><td>TAC, DIP, ROT, SLI</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('switches')">Add</button></td>
                </tr>
                <tr data-category="relays">
                    <td>REL</td><td>Relays</td><td>EMR, SSR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('relays')">Add</button></td>
                </tr>
                <tr data-category="optocouplers">
                    <td>OPT</td><td>Optocouplers</td><td>STD, HIS, DAR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('optocouplers')">Add</button></td>
                </tr>
                <tr data-category="sensors">
                    <td>SEN</td><td>Sensors</td><td>TMP, PRE, ACC, GYR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('sensors')">Add</button></td>
                </tr>
                <tr data-category="mechanical">
                    <td>MEC</td><td>Mechanical</td><td>ENC, FAN, HEA, SPK</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('mechanical')">Add</button></td>
                </tr>
                <tr data-category="hardware">
                    <td>HWR</td><td>Hardware</td><td>SCR, NUT, WSH, SPC</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('hardware')">Add</button></td>
                </tr>
                <tr data-category="cables">
                    <td>CBL</td><td>Cables & Wires</td><td>PWR, SIG, COA, FFC</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('cables')">Add</button></td>
                </tr>
            </table>
        </div>

        <!-- Add Component Sheet -->
        <div id="add-component" class="sheet">
            <div class="section-header">➕ Add New Component</div>
            <div class="add-component-form">
                <h3>Component Information</h3>
                <form id="addComponentForm" onsubmit="event.preventDefault(); addComponent();">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="categorySelect">Category *</label>
                            <select id="categorySelect" name="category" required>
                                <option value="">Select Category</option>
                                <option value="capacitors">Capacitors</option>
                                <option value="resistors">Resistors</option>
                                <option value="inductors">Inductors</option>
                                <option value="diodes">Diodes</option>
                                <option value="transistors">Transistors</option>
                                <option value="ics">Integrated Circuits</option>
                                <option value="connectors">Connectors</option>
                                <option value="crystals">Crystals & Oscillators</option>
                                <option value="fuses">Fuses</option>
                                <option value="switches">Switches</option>
                                <option value="relays">Relays</option>
                                <option value="optocouplers">Optocouplers</option>
                                <option value="sensors">Sensors</option>
                                <option value="mechanical">Mechanical</option>
                                <option value="hardware">Hardware</option>
                                <option value="cables">Cables & Wires</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="subcategorySelect">Subcategory *</label>
                            <select id="subcategorySelect" name="subcategory" required>
                                <option value="">Select Subcategory</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="kinbenPN">Kinben PN (Auto-generated)</label>
                            <input type="text" id="kinbenPN" name="kinbenPN" readonly style="background: #f0f0f0;">
                            <small id="kpnPreview" style="color: #666;">Select category and subcategory</small>
                        </div>
                        <div class="form-group">
                            <label for="value">Value</label>
                            <input type="text" id="value" name="value" placeholder="e.g., 100nF, 1kΩ, 10µH">
                        </div>
                        <div class="form-group">
                            <label for="voltage">Voltage Rating</label>
                            <input type="text" id="voltage" name="voltage" placeholder="e.g., 50V, 3.3V">
                        </div>
                        <div class="form-group">
                            <label for="current">Current Rating</label>
                            <input type="text" id="current" name="current" placeholder="e.g., 1A, 500mA">
                        </div>
                        <div class="form-group">
                            <label for="power">Power Rating</label>
                            <input type="text" id="power" name="power" placeholder="e.g., 0.25W, 1W">
                        </div>
                        <div class="form-group">
                            <label for="tolerance">Tolerance</label>
                            <input type="text" id="tolerance" name="tolerance" placeholder="e.g., ±5%, ±1%">
                        </div>
                        <div class="form-group">
                            <label for="package">Package</label>
                            <input type="text" id="package" name="package" placeholder="e.g., 0603, SOIC-8, TO-220">
                        </div>
                        <div class="form-group">
                            <label for="mounting">Mounting</label>
                            <select id="mounting" name="mounting">
                                <option value="">Select</option>
                                <option value="SMD">SMD</option>
                                <option value="THT">Through Hole</option>
                                <option value="Both">Both</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="temperature">Temperature Range</label>
                            <input type="text" id="temperature" name="temperature" placeholder="e.g., -40°C to +85°C">
                        </div>
                        <div class="form-group">
                            <label for="manufacturer">Manufacturer</label>
                            <input type="text" id="manufacturer" name="manufacturer" placeholder="e.g., Murata, TI, Vishay">
                        </div>
                        <div class="form-group">
                            <label for="manufacturerPN">Manufacturer PN</label>
                            <input type="text" id="manufacturerPN" name="manufacturerPN" placeholder="Manufacturer part number">
                        </div>
                        <div class="form-group">
                            <label for="supplier">Preferred Supplier</label>
                            <select id="supplier" name="supplier">
                                <option value="">Select</option>
                                <option value="Mouser">Mouser</option>
                                <option value="DigiKey">DigiKey</option>
                                <option value="FIDES">FIDES</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="mouserPN">Mouser PN</label>
                            <input type="text" id="mouserPN" name="mouserPN" placeholder="Mouser part number">
                        </div>
                        <div class="form-group">
                            <label for="digikeyPN">DigiKey PN</label>
                            <input type="text" id="digikeyPN" name="digikeyPN" placeholder="DigiKey part number">
                        </div>
                        <div class="form-group">
                            <label for="cost">Unit Cost (USD)</label>
                            <input type="number" id="cost" name="cost" step="0.01" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label for="moq">MOQ</label>
                            <input type="number" id="moq" name="moq" placeholder="Minimum order quantity">
                        </div>
                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status">
                                <option value="Active">Active</option>
                                <option value="Pending">Pending</option>
                                <option value="Obsolete">Obsolete</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="symbolFile">Symbol File</label>
                            <input type="text" id="symbolFile" name="symbolFile" placeholder="KiCad symbol filename">
                        </div>
                        <div class="form-group">
                            <label for="footprintFile">Footprint File</label>
                            <input type="text" id="footprintFile" name="footprintFile" placeholder="KiCad footprint filename">
                        </div>
                        <div class="form-group">
                            <label for="modelFile">3D Model File</label>
                            <input type="text" id="modelFile" name="modelFile" placeholder="3D model filename">
                        </div>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" placeholder="Detailed component description"></textarea>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label for="notes">Notes</label>
                        <textarea id="notes" name="notes" placeholder="Additional notes, special requirements, etc."></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-success">✅ Add Component</button>
                        <button type="reset" class="btn btn-warning">🔄 Reset Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Component Category Sheets (Enhanced) -->
        <div id="capacitors" class="sheet">
            <div class="section-header">🔋 CAPACITORS - Category Code: CAP</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('capacitors')">➕ Add Capacitor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'capacitors')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportData('json', 'capacitors')">📊 Export JSON</button>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th>Kinben PN</th><th>Value</th><th>Voltage Rating</th><th>Tolerance</th><th>Package</th>
                        <th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th>
                        <th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th>
                        <th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th>
                        <th>3D Model File</th><th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Capacitor" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <div id="resistors" class="sheet">
            <div class="section-header">⚡ RESISTORS - Category Code: RES</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('resistors')">➕ Add Resistor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'resistors')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportData('json', 'resistors')">📊 Export JSON</button>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th>Kinben PN</th><th>Value</th><th>Power Rating</th><th>Tolerance</th><th>Package</th>
                        <th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th>
                        <th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th>
                        <th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th>
                        <th>3D Model File</th><th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Resistor" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Add similar structure for other categories -->
        <div id="inductors" class="sheet">
            <div class="section-header">🌀 INDUCTORS - Category Code: IND</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('inductors')">➕ Add Inductor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'inductors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Value</th><th>Current Rating</th><th>DCR</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Inductor" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="diodes" class="sheet">
            <div class="section-header">💡 DIODES - Category Code: DIO</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('diodes')">➕ Add Diode</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'diodes')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Voltage Rating</th><th>Current Rating</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Diode" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="transistors" class="sheet">
            <div class="section-header">🔧 TRANSISTORS - Category Code: TRA</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('transistors')">➕ Add Transistor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'transistors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Voltage Rating</th><th>Current Rating</th><th>Power Rating</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Transistor" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="ics" class="sheet">
            <div class="section-header">🖥️ INTEGRATED CIRCUITS - Category Code: IC</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('ics')">➕ Add IC</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'ics')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Voltage Rating</th><th>Current Rating</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Pin Count</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add IC" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="connectors" class="sheet">
            <div class="section-header">🔌 CONNECTORS - Category Code: CON</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('connectors')">➕ Add Connector</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'connectors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Positions</th><th>Current Rating</th><th>Voltage Rating</th><th>Pitch</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Connector" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="crystals" class="sheet">
            <div class="section-header">🔮 CRYSTALS & OSCILLATORS - Category Code: CRY</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('crystals')">➕ Add Crystal/Oscillator</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'crystals')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Frequency</th><th>Tolerance</th><th>Load Capacitance</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Crystal/Oscillator" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="fuses" class="sheet">
            <div class="section-header">🛡️ FUSES - Category Code: FUS</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('fuses')">➕ Add Fuse</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'fuses')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Current Rating</th><th>Voltage Rating</th><th>Type</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Fuse" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="switches" class="sheet">
            <div class="section-header">🔘 SWITCHES - Category Code: SWI</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('switches')">➕ Add Switch</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'switches')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Current Rating</th><th>Voltage Rating</th><th>Actuator Type</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Switch" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="relays" class="sheet">
            <div class="section-header">🔄 RELAYS - Category Code: REL</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('relays')">➕ Add Relay</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'relays')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Coil Voltage</th><th>Contact Rating</th><th>Contact Config</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Relay" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="optocouplers" class="sheet">
            <div class="section-header">💡 OPTOCOUPLERS - Category Code: OPT</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('optocouplers')">➕ Add Optocoupler</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'optocouplers')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>CTR</th><th>Isolation Voltage</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Optocoupler" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="sensors" class="sheet">
            <div class="section-header">📡 SENSORS - Category Code: SEN</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('sensors')">➕ Add Sensor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'sensors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Range</th><th>Accuracy</th><th>Supply Voltage</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Sensor" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="mechanical" class="sheet">
            <div class="section-header">⚙️ MECHANICAL - Category Code: MEC</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('mechanical')">➕ Add Mechanical Component</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'mechanical')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Specifications</th><th>Material</th><th>Dimensions</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Mechanical Component" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="hardware" class="sheet">
            <div class="section-header">🔩 HARDWARE - Category Code: HWR</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('hardware')">➕ Add Hardware</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'hardware')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Size</th><th>Material</th><th>Finish</th><th>Thread Type</th><th>Length</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Hardware" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="cables" class="sheet">
            <div class="section-header">🔌 CABLES & WIRES - Category Code: CBL</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('cables')">➕ Add Cable/Wire</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'cables')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>AWG/Size</th><th>Length</th><th>Connector A</th><th>Connector B</th><th>Shielding</th><th>Color</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Cable/Wire" to get started!</td></tr></tbody>
            </table>
        </div>

        <!-- Search Results Sheet -->
        <div id="search-results" class="sheet">
            <div class="section-header">🔍 Search Results</div>
            <div class="search-results-header">
                <div class="search-results-info">
                    <h3>Found <span id="search-results-count">0</span> results for "<span id="search-term-display">-</span>"</h3>
                </div>
                <div class="search-results-actions">
                    <button class="btn btn-success" onclick="exportData('csv', null)" title="Export search results">📄 Export CSV</button>
                    <button class="btn btn-warning" onclick="clearSearch()">🔄 New Search</button>
                    <button class="btn btn-primary" onclick="showSheet('landing')">📊 Back to Dashboard</button>
                </div>
            </div>
            
            <table class="search-results-table">
                <thead>
                    <tr>
                        <th>Kinben PN</th>
                        <th>Category</th>
                        <th>Value</th>
                        <th>Manufacturer</th>
                        <th>Manufacturer PN</th>
                        <th>Description</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="8" style="text-align: center; color: #666; padding: 20px;">Use the search function above to find components across all categories.</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Add Component Modal -->
        <div id="addComponentModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeAddComponentModal()">&times;</span>
                <h2>Add New Component</h2>
                <p>This modal provides an alternative way to add components. Use the dedicated "Add Component" sheet for a better experience.</p>
                <button class="btn btn-primary" onclick="closeAddComponentModal(); showSheet('add-component')">Go to Add Component Sheet</button>
            </div>
        </div>
    </div>
</body>
</html>