<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Kinben KPN System Master Workbook</title>
    <style>
        body { font-family: Calibri, Arial, sans-serif; margin: 0; }
        .workbook-container { padding: 20px; }
        .sheet-tabs { border-bottom: 2px solid #0078d4; margin-bottom: 20px; overflow-x: auto; white-space: nowrap; }
        .tab { display: inline-block; padding: 10px 20px; margin-right: 5px; background: #f5f5f5; border: 1px solid #ccc; cursor: pointer; border-radius: 5px 5px 0 0; transition: all 0.3s; }
        .tab:hover { background: #e3f2fd; }
        .tab.active { background: #0078d4; color: white; border-bottom: 2px solid #0078d4; }
        .sheet { display: none; }
        .sheet.active { display: block; }
        
        /* Enhanced Landing Page */
        .landing-page { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 10px; margin-bottom: 30px; }
        .landing-title { font-size: 32px; font-weight: bold; text-align: center; margin-bottom: 20px; }
        .landing-subtitle { font-size: 18px; text-align: center; margin-bottom: 30px; opacity: 0.9; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .info-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; }
        .info-card h3 { margin-top: 0; color: #fff; }
        .naming-convention { background: rgba(255,255,255,0.15); padding: 20px; border-radius: 8px; margin: 20px 0; }
        
        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .stat-number { font-size: 32px; font-weight: bold; color: #0078d4; }
        .stat-label { color: #666; font-size: 14px; margin-top: 5px; }
        
        /* Action Buttons */
        .action-buttons { display: flex; gap: 15px; margin: 20px 0; flex-wrap: wrap; }
        .btn { padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; text-decoration: none; display: inline-block; transition: all 0.3s; }
        .btn-primary { background: #0078d4; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-info { background: #17a2b8; color: white; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        
        /* Search and Filter */
        .search-controls { background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .search-input { width: 300px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px; }
        .filter-select { padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px; }
        
        /* Tables */
        .category-table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .category-table th { background: #0078d4; color: white; padding: 12px; text-align: left; font-weight: bold; }
        .category-table td { padding: 10px 12px; border-bottom: 1px solid #eee; }
        .category-table tr:nth-child(even) { background: #f9f9f9; }
        .category-table tr:hover { background: #e3f2fd; }
        .component-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 10px; }
        .component-table th { background: #2c5aa0; color: white; padding: 8px; text-align: left; font-weight: bold; position: sticky; top: 0; }
        .component-table td { padding: 6px 8px; border-bottom: 1px solid #ddd; white-space: nowrap; }
        .component-table tr:nth-child(even) { background: #f8f9fa; }
        .component-table tr:hover { background: #e3f2fd; }
        
        /* Status indicators */
        .status-active { color: #28a745; font-weight: bold; }
        .status-pending { color: #ffc107; font-weight: bold; }
        .status-obsolete { color: #dc3545; font-weight: bold; }
        
        /* Section headers */
        .section-header { background: #f1f3f4; padding: 15px; margin: 20px 0 10px 0; border-left: 4px solid #0078d4; font-weight: bold; border-radius: 0 8px 8px 0; }
        
        /* Add Component Form */
        .add-component-form { background: #f8f9fa; padding: 30px; border-radius: 10px; margin: 20px 0; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { margin-bottom: 5px; font-weight: bold; color: #333; }
        .form-group input, .form-group select, .form-group textarea { padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .form-group textarea { resize: vertical; min-height: 80px; }
        
        /* Modal styles */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 30px; border-radius: 10px; width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: #000; }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .action-buttons { flex-direction: column; }
            .info-grid { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .search-input { width: 100%; margin-bottom: 10px; }
            .sheet-tabs { padding-bottom: 10px; }
        }
        
        /* Export styles */
        .export-options { background: white; padding: 20px; border-radius: 8px; margin: 10px 0; }
        .export-button { margin: 5px; }
        
        /* Search Results styles */
        .search-results-header { display: flex; justify-content: between; align-items: center; margin-bottom: 20px; }
        .search-results-info { flex: 1; }
        .search-results-actions { display: flex; gap: 10px; }
        .search-results-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .search-results-table th { background: #28a745; color: white; padding: 12px; text-align: left; font-weight: bold; }
        .search-results-table td { padding: 10px 12px; border-bottom: 1px solid #ddd; }
        .search-results-table tr:nth-child(even) { background: #f8f9fa; }
        .search-results-table tr:hover { background: #e3f2fd; }
        .category-badge { background: #007bff; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        .search-highlight { background-color: #ffeb3b; font-weight: bold; }
        mark { background-color: #ffeb3b; padding: 1px 2px; border-radius: 2px; }
        
        /* Real-time search */
        .search-input-container { position: relative; display: inline-block; }
        .search-suggestions { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); z-index: 100; max-height: 200px; overflow-y: auto; display: none; }
        .search-suggestion-item { padding: 10px; cursor: pointer; border-bottom: 1px solid #eee; }
        .search-suggestion-item:hover { background: #f0f0f0; }
        .search-suggestion-item:last-child { border-bottom: none; }
        
        /* Category page filters */
        .category-filters { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #28a745; }
        .category-filters h4 { margin: 0 0 15px 0; color: #333; font-size: 16px; }
        .filter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end; }
        .filter-group { display: flex; flex-direction: column; }
        .filter-group label { margin-bottom: 5px; font-weight: bold; color: #555; font-size: 14px; }
        .filter-input, .filter-select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .filter-actions { display: flex; gap: 10px; align-items: end; }
        .filter-stats { background: #e3f2fd; padding: 10px 15px; border-radius: 4px; margin-top: 10px; font-size: 14px; color: #1565c0; }
        .hidden-row { display: none !important; }
        
        /* Sortable columns */
        .sortable-header { cursor: pointer; user-select: none; position: relative; padding-right: 20px !important; }
        .sortable-header:hover { background-color: rgba(255, 255, 255, 0.1); }
        .sort-indicator { position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 12px; opacity: 0.7; }
        .sort-asc::after { content: " ↑"; }
        .sort-desc::after { content: " ↓"; }
        
        /* Filter badges */
        .active-filters { margin: 10px 0; display: flex; flex-wrap: wrap; gap: 8px; }
        .filter-badge { background: #007bff; color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; display: flex; align-items: center; gap: 6px; }
        .filter-badge .remove-filter { cursor: pointer; background: rgba(255,255,255,0.3); border-radius: 50%; width: 16px; height: 16px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .filter-badge .remove-filter:hover { background: rgba(255,255,255,0.5); }
        
        /* System-level management styles */
        .system-card { background: white; border-radius: 8px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #28a745; }
        .system-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .system-title { font-size: 18px; font-weight: bold; color: #333; }
        .system-kn { background: #28a745; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .system-meta { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 10px 0; font-size: 14px; }
        .meta-item { display: flex; flex-direction: column; }
        .meta-label { font-weight: bold; color: #666; font-size: 12px; }
        .meta-value { color: #333; }
        .hierarchy-view { background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 10px 0; }
        .hierarchy-level { margin-left: 20px; border-left: 2px solid #dee2e6; padding-left: 15px; margin-bottom: 10px; }
        .file-attachments { display: flex; gap: 8px; flex-wrap: wrap; margin: 10px 0; }
        .file-badge { background: #17a2b8; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; text-decoration: none; }
        .file-badge:hover { background: #138496; color: white; }
        
        /* BOM hierarchy styles */
        .bom-tree { font-family: monospace; font-size: 12px; background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 10px 0; }
        .bom-level-0 { font-weight: bold; color: #28a745; }
        .bom-level-1 { margin-left: 20px; color: #0078d4; }
        .bom-level-2 { margin-left: 40px; color: #6c757d; }
        .bom-level-3 { margin-left: 60px; color: #6c757d; font-style: italic; }
        
        /* Enhanced dashboard for system-level */
        .system-overview { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0; }
        .overview-card { background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 20px; border-radius: 10px; text-align: center; }
        .overview-number { font-size: 24px; font-weight: bold; }
        .overview-label { font-size: 14px; opacity: 0.9; }
        
        /* Migration-ready data attributes */
        [data-system-id] { cursor: pointer; }
        [data-assembly-id] { border-left: 3px solid #0078d4; }
        [data-component-id] { border-left: 2px solid #6c757d; }
    </style>
    <script>
        // Component data storage
        let componentData = {
            capacitors: [], resistors: [], inductors: [], diodes: [], transistors: [],
            ics: [], connectors: [], crystals: [], fuses: [], switches: [],
            relays: [], optocouplers: [], sensors: [], mechanical: [], hardware: [], cables: []
        };
        
        // System-level data storage
        let systemData = {
            systems: [],      // SKN - Complete products/projects
            assemblies: [],   // AKN - PCBAs, mechanical assemblies
            '3d-parts': [],   // 3PN - 3D printed components
            'cable-assemblies': [] // CAN - Cable harnesses
        };
        
        // Category configurations
        const categoryConfigs = {
            capacitors: { code: 'CAP', subcategories: ['CER', 'ELE', 'TAN', 'FIL'] },
            resistors: { code: 'RES', subcategories: ['STD', 'PRE', 'VAR', 'NET'] },
            inductors: { code: 'IND', subcategories: ['PWR', 'CHK', 'FER'] },
            diodes: { code: 'DIO', subcategories: ['STD', 'LED', 'ZEN', 'SCH'] },
            transistors: { code: 'TRA', subcategories: ['BJT', 'FET', 'MOS'] },
            ics: { code: 'IC', subcategories: ['MCU', 'ANA', 'DIG', 'PWR'] },
            connectors: { code: 'CON', subcategories: ['HDR', 'JST', 'USB', 'RJ45'] },
            crystals: { code: 'CRY', subcategories: ['XTL', 'OSC', 'RES'] },
            fuses: { code: 'FUS', subcategories: ['STD', 'RST', 'PTC'] },
            switches: { code: 'SWI', subcategories: ['TAC', 'DIP', 'ROT', 'SLI'] },
            relays: { code: 'REL', subcategories: ['EMR', 'SSR'] },
            optocouplers: { code: 'OPT', subcategories: ['STD', 'HIS', 'DAR'] },
            sensors: { code: 'SEN', subcategories: ['TMP', 'PRE', 'ACC', 'GYR'] },
            mechanical: { code: 'MEC', subcategories: ['ENC', 'FAN', 'HEA', 'SPK'] },
            hardware: { code: 'HWR', subcategories: ['SCR', 'NUT', 'WSH', 'SPC'] },
            cables: { code: 'CBL', subcategories: ['PWR', 'SIG', 'COA', 'FFC'] }
        };
        
        // System-level configurations
        const systemConfigs = {
            systems: { code: 'SKN', subcategories: ['PROD', 'PROTO', 'EVAL', 'TEST'] },
            assemblies: { code: 'AKN', subcategories: ['PCBA', 'MECH', 'OPT', 'SENS'] },
            '3d-parts': { code: '3PN', subcategories: ['ENCL', 'BRKT', 'SPAC', 'CONN'] },
            'cable-assemblies': { code: 'CAN', subcategories: ['PWR', 'DATA', 'CTRL', 'RF'] }
        };

        // ==================== PRIORITY: SYSTEM-FIRST MANAGEMENT ====================

        // Generate system-level part numbers with priority for multiboard systems
        function generateSystemKN(category, subcategory) {
            const config = systemConfigs[category];
            if (!config) return '';
            
            let maxSequence = 0;
            systemData[category].forEach(item => {
                const kn = item.systemKN || item.assemblyKN || item.partKN || item.cableKN;
                if (kn && kn.startsWith(config.code)) {
                    const parts = kn.split('-');
                    if (parts.length >= 3) {
                        const sequence = parseInt(parts[2]);
                        if (sequence > maxSequence) maxSequence = sequence;
                    }
                }
            });
            
            const nextSequence = (maxSequence + 1).toString().padStart(3, '0');
            return `${config.code}-${subcategory}-${nextSequence}`;
        }

        // Update system statistics with multiboard focus
        function updateSystemStats() {
            let totalSystems = systemData.systems.length;
            let totalAssemblies = systemData.assemblies.length;
            let totalMultiboard = systemData.systems.filter(s => s.assemblies > 1).length;
            
            const systemsElement = document.getElementById('total-systems');
            const assembliesElement = document.getElementById('total-assemblies');
            const multiboardElement = document.getElementById('total-multiboard');
            
            if (systemsElement) systemsElement.textContent = totalSystems;
            if (assembliesElement) assembliesElement.textContent = totalAssemblies;
            if (multiboardElement) multiboardElement.textContent = totalMultiboard;
            
            Object.keys(systemData).forEach(category => {
                const total = systemData[category].length;
                const active = systemData[category].filter(item => item.status === 'Active').length;
                
                const totalElement = document.getElementById(`${category}-count`);
                const activeElement = document.getElementById(`${category}-active`);
                
                if (totalElement) totalElement.textContent = total;
                if (activeElement) activeElement.textContent = active;
            });
        }

        // Refresh system-level tables
        function refreshSystemTable(category) {
            let table;
            
            // Handle categories that start with numbers - use attribute selector
            if (category === '3d-parts') {
                table = document.querySelector('[id="3d-parts"] .component-table tbody');
            } else {
                table = document.querySelector(`#${category} .component-table tbody`);
            }
            
            if (!table) return;
            
            table.innerHTML = '';
            const items = systemData[category] || [];
            
            if (items.length === 0) {
                const colCount = table.closest('table').querySelector('thead tr').children.length;
                table.innerHTML = `<tr><td colspan="${colCount}" style="text-align: center; color: #666; padding: 20px;">No ${category.replace('-', ' ')} added yet. Click "Add ${category.charAt(0).toUpperCase() + category.slice(1).replace('-', ' ')}" to get started!</td></tr>`;
                return;
            }
            
            items.forEach(item => {
                const row = document.createElement('tr');
                row.setAttribute(`data-${category.slice(0, -1)}-id`, item.id || Date.now());
                
                // Build row based on category type
                switch(category) {
                    case 'systems':
                        row.innerHTML = `
                            <td>${item.systemKN}</td>
                            <td>${item.name}</td>
                            <td>${item.version}</td>
                            <td>${item.type}</td>
                            <td><span class="status-${item.status.toLowerCase()}">${item.status}</span></td>
                            <td>${item.assemblies || 0}</td>
                            <td>${item.description}</td>
                            <td>${item.owner || 'N/A'}</td>
                            <td><div class="file-attachments">${(item.files || []).map(f => `<a href="#" class="file-badge">${f}</a>`).join('')}</div></td>
                            <td><button class="btn btn-sm btn-info" onclick="viewSystemDetails('${item.systemKN}')">View</button></td>
                        `;
                        break;
                    case 'assemblies':
                        row.innerHTML = `
                            <td>${item.assemblyKN}</td>
                            <td>${item.name}</td>
                            <td>${item.type}</td>
                            <td>${item.version}</td>
                            <td><span class="status-${item.status.toLowerCase()}">${item.status}</span></td>
                            <td>${item.components || 0}</td>
                            <td>${item.description}</td>
                            <td><div class="file-attachments">${(item.files || []).map(f => `<a href="#" class="file-badge">${f}</a>`).join('')}</div></td>
                            <td><button class="btn btn-sm btn-info" onclick="viewSystemDetails('${item.assemblyKN}')">View</button></td>
                        `;
                        break;
                    case '3d-parts':
                        row.innerHTML = `
                            <td>${item.partKN}</td>
                            <td>${item.name}</td>
                            <td>${item.type}</td>
                            <td>${item.material}</td>
                            <td><span class="status-${item.status.toLowerCase()}">${item.status}</span></td>
                            <td>${item.version}</td>
                            <td>${item.description}</td>
                            <td><div class="file-attachments">${(item.files || []).map(f => `<a href="#" class="file-badge">${f}</a>`).join('')}</div></td>
                            <td><button class="btn btn-sm btn-info" onclick="viewSystemDetails('${item.partKN}')">View</button></td>
                        `;
                        break;
                    case 'cable-assemblies':
                        row.innerHTML = `
                            <td>${item.cableKN}</td>
                            <td>${item.name}</td>
                            <td>${item.type}</td>
                            <td>${item.length}</td>
                            <td>${item.connectors}</td>
                            <td><span class="status-${item.status.toLowerCase()}">${item.status}</span></td>
                            <td>${item.description}</td>
                            <td><div class="file-attachments">${(item.files || []).map(f => `<a href="#" class="file-badge">${f}</a>`).join('')}</div></td>
                            <td><button class="btn btn-sm btn-info" onclick="viewSystemDetails('${item.cableKN}')">View</button></td>
                        `;
                        break;
                }
                
                table.appendChild(row);
            });
        }

        // Sort system-level tables
        function sortSystemTable(category, column) {
            let table;
            
            // Handle categories that start with numbers
            if (category === '3d-parts') {
                table = document.querySelector('[id="3d-parts"] .component-table');
            } else {
                table = document.querySelector(`#${category} .component-table`);
            }
            
            if (!table) return;
            
            const headers = table.querySelectorAll('th.sortable-header');
            const currentHeader = Array.from(headers).find(h => h.onclick && h.onclick.toString().includes(`'${column}'`));
            
            // Clear all sort indicators
            headers.forEach(h => h.classList.remove('sort-asc', 'sort-desc'));
            
            // Determine sort direction
            let ascending = true;
            if (currentHeader && currentHeader.classList.contains('sort-asc')) {
                ascending = false;
                currentHeader.classList.add('sort-desc');
            } else if (currentHeader) {
                currentHeader.classList.add('sort-asc');
            }
            
            // Sort data
            systemData[category].sort((a, b) => {
                let valA = a[column] || '';
                let valB = b[column] || '';
                
                // Handle numeric values
                if (!isNaN(valA) && !isNaN(valB)) {
                    return ascending ? valA - valB : valB - valA;
                }
                
                // Handle string values
                valA = valA.toString().toLowerCase();
                valB = valB.toString().toLowerCase();
                
                if (ascending) {
                    return valA < valB ? -1 : valA > valB ? 1 : 0;
                } else {
                    return valA > valB ? -1 : valA < valB ? 1 : 0;
                }
            });
            
            refreshSystemTable(category);
        }

        // Export system-level data
        function exportSystemData(format, category) {
            const items = systemData[category] || [];
            if (items.length === 0) {
                alert(`No ${category.replace('-', ' ')} to export.`);
                return;
            }
            
            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
            let filename = `${category}_${timestamp}`;
            let content, mimeType;
            
            if (format === 'csv') {
                // Generate CSV headers based on category
                let headers = [];
                switch(category) {
                    case 'systems':
                        headers = ['System KN', 'Name', 'Version', 'Type', 'Status', 'Assemblies', 'Description', 'Owner', 'Files'];
                        break;
                    case 'assemblies':
                        headers = ['Assembly KN', 'Name', 'Type', 'Version', 'Status', 'Components', 'Description', 'Files'];
                        break;
                    case '3d-parts':
                        headers = ['Part KN', 'Name', 'Type', 'Material', 'Status', 'Version', 'Description', 'Files'];
                        break;
                    case 'cable-assemblies':
                        headers = ['Cable KN', 'Name', 'Type', 'Length', 'Connectors', 'Status', 'Description', 'Files'];
                        break;
                }
                
                content = headers.join(',') + '\n';
                items.forEach(item => {
                    const row = headers.map(header => {
                        const key = header.toLowerCase().replace(/\s+/g, '').replace('kn', 'KN');
                        let value = '';
                        switch(key) {
                            case 'systemKN': value = item.systemKN || ''; break;
                            case 'assemblyKN': value = item.assemblyKN || ''; break;
                            case 'partKN': value = item.partKN || ''; break;
                            case 'cableKN': value = item.cableKN || ''; break;
                            case 'files': value = (item.files || []).join(';'); break;
                            default:
                                const prop = key.charAt(0).toLowerCase() + key.slice(1);
                                value = item[prop] || '';
                        }
                        return `"${value.toString().replace(/"/g, '""')}"`;
                    });
                    content += row.join(',') + '\n';
                });
                
                filename += '.csv';
                mimeType = 'text/csv';
            } else {
                content = JSON.stringify(items, null, 2);
                filename += '.json';
                mimeType = 'application/json';
            }
            
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Quick system modal for multiboard ordering
        function openAddSystemModal(category) {
            alert(`System management for ${category} - Implementation in progress. This will open a modal for creating multiboard systems with multiple PCBAs.`);
        }

        // Multiboard project wizard
        function openMultiboardWizard() {
            alert('Multiboard Project Wizard - This will help you create complete systems with multiple PCBAs, cable assemblies, and 3D printed components.');
        }

        // View system details (placeholder for future expansion)
        function viewSystemDetails(kn) {
            alert(`System details for ${kn} - This feature will be expanded for hierarchical BOM views and detailed system management.`);
        }

        // Load system data from localStorage
        function loadSystemData() {
            const saved = localStorage.getItem('kinbenSystemData');
            if (saved) {
                try {
                    systemData = JSON.parse(saved);
                } catch (e) {
                    console.warn('Failed to load system data from localStorage');
                }
            }
        }

        // Initialize system management on page load
        function initializeSystemManagement() {
            loadSystemData();
            updateSystemStats();
            
            // Refresh all system tables
            Object.keys(systemData).forEach(category => {
                refreshSystemTable(category);
            });
            
            console.log('System-first management initialized for multiboard ordering');
        }

        function showSheet(sheetName) {
            // Hide all sheets
            const sheets = document.querySelectorAll('.sheet');
            sheets.forEach(sheet => sheet.classList.remove('active'));
            
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected sheet and tab
            document.getElementById(sheetName).classList.add('active');
            event.target.classList.add('active');
            
            // Update component counts and refresh tables
            updateStats();
            
            // Handle system-level sheets first
            if (['systems', 'assemblies', '3d-parts', 'cable-assemblies'].includes(sheetName)) {
                updateSystemStats();
                refreshSystemTable(sheetName);
                console.log(`Switched to ${sheetName} for system management`);
            } else if (sheetName !== 'landing') {
                refreshComponentTable(sheetName);
            }
        }
        
        function updateStats() {
            let totalComponents = 0;
            let activeCategories = 0;
            
            Object.keys(componentData).forEach(category => {
                const count = componentData[category].length;
                totalComponents += count;
                if (count > 0) activeCategories++;
                
                // Update category table counts
                const categoryRow = document.querySelector(`[data-category="${category}"]`);
                if (categoryRow) {
                    categoryRow.querySelector('.count-cell').textContent = count;
                }
            });
            
            // Update stats cards
            document.getElementById('total-components').textContent = totalComponents;
            document.getElementById('active-categories').textContent = activeCategories;
            document.getElementById('total-categories').textContent = Object.keys(componentData).length;
            
            // Add system-level statistics
            let totalSystems = systemData.systems.length;
            let totalAssemblies = systemData.assemblies.length;
            let totalMultiboard = systemData.systems.filter(s => s.assemblies > 1).length;
            
            const systemsElement = document.getElementById('total-systems');
            const assembliesElement = document.getElementById('total-assemblies');
            const multiboardElement = document.getElementById('total-multiboard');
            
            if (systemsElement) systemsElement.textContent = totalSystems;
            if (assembliesElement) assembliesElement.textContent = totalAssemblies;
            if (multiboardElement) multiboardElement.textContent = totalMultiboard;
        }
        
        function generateKPN(category, subcategory) {
            const categoryData = componentData[category] || [];
            const categoryCode = categoryConfigs[category].code;
            const sequence = (categoryData.length + 1).toString().padStart(4, '0');
            return `KPN-${categoryCode}-${subcategory}-${sequence}`;
        }
        
        function openAddComponentModal(category) {
            const modal = document.getElementById('addComponentModal');
            const form = document.getElementById('addComponentForm');
            const categorySelect = document.getElementById('categorySelect');
            const subcategorySelect = document.getElementById('subcategorySelect');
            
            // Set category
            categorySelect.value = category;
            updateSubcategories();
            
            // Show modal
            modal.style.display = 'block';
        }
        
        function closeAddComponentModal() {
            document.getElementById('addComponentModal').style.display = 'none';
        }
        
        function updateSubcategories() {
            const categorySelect = document.getElementById('categorySelect');
            const subcategorySelect = document.getElementById('subcategorySelect');
            const category = categorySelect.value;
            
            subcategorySelect.innerHTML = '<option value="">Select Subcategory</option>';
            
            if (category && categoryConfigs[category]) {
                categoryConfigs[category].subcategories.forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subcategorySelect.appendChild(option);
                });
            }
        }
        
        function generateKPNPreview() {
            const category = document.getElementById('categorySelect').value;
            const subcategory = document.getElementById('subcategorySelect').value;
            const preview = document.getElementById('kpnPreview');
            
            if (category && subcategory) {
                const kpn = generateKPN(category, subcategory);
                preview.textContent = kpn;
                document.getElementById('kinbenPN').value = kpn;
            } else {
                preview.textContent = 'Select category and subcategory';
                document.getElementById('kinbenPN').value = '';
            }
        }
        
        function addComponent() {
            const form = document.getElementById('addComponentForm');
            const formData = new FormData(form);
            const category = formData.get('category');
            
            if (!category) {
                alert('Please select a category');
                return;
            }
            
            // Create component object
            const component = {
                kinbenPN: formData.get('kinbenPN'),
                value: formData.get('value'),
                voltage: formData.get('voltage'),
                current: formData.get('current'),
                power: formData.get('power'),
                tolerance: formData.get('tolerance'),
                package: formData.get('package'),
                mounting: formData.get('mounting'),
                temperature: formData.get('temperature'),
                manufacturer: formData.get('manufacturer'),
                manufacturerPN: formData.get('manufacturerPN'),
                description: formData.get('description'),
                supplier: formData.get('supplier'),
                mouserPN: formData.get('mouserPN'),
                digikeyPN: formData.get('digikeyPN'),
                cost: formData.get('cost'),
                moq: formData.get('moq'),
                status: formData.get('status') || 'Active',
                symbolFile: formData.get('symbolFile'),
                footprintFile: formData.get('footprintFile'),
                modelFile: formData.get('modelFile'),
                notes: formData.get('notes'),
                createdDate: new Date().toISOString().split('T')[0],
                createdBy: 'User'
            };
            
            // Add to component data
            if (!componentData[category]) {
                componentData[category] = [];
            }
            componentData[category].push(component);
            
            // Close modal and refresh
            closeAddComponentModal();
            form.reset();
            updateStats();
            
            // If we're on the category sheet, refresh it
            const activeSheet = document.querySelector('.sheet.active');
            if (activeSheet && activeSheet.id === category) {
                refreshComponentTable(category);
            }
            
            alert('Component added successfully!');
        }
        
        function refreshComponentTable(category) {
            const table = document.querySelector(`#${category} .component-table tbody`);
            if (!table) return;
            
            const components = componentData[category] || [];
            
            if (components.length === 0) {
                table.innerHTML = '<tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Component" to get started!</td></tr>';
                return;
            }
            
            table.innerHTML = '';
            components.forEach(component => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${component.kinbenPN}</td>
                    <td>${component.value || '-'}</td>
                    <td>${component.voltage || '-'}</td>
                    <td>${component.tolerance || '-'}</td>
                    <td>${component.package || '-'}</td>
                    <td>${component.mounting || '-'}</td>
                    <td>${component.temperature || '-'}</td>
                    <td>${component.manufacturer || '-'}</td>
                    <td>${component.manufacturerPN || '-'}</td>
                    <td>${component.description || '-'}</td>
                    <td>${component.supplier || '-'}</td>
                    <td>${component.mouserPN || '-'}</td>
                    <td>${component.digikeyPN || '-'}</td>
                    <td>${component.cost || '-'}</td>
                    <td>${component.moq || '-'}</td>
                    <td><span class="status-${component.status.toLowerCase()}">${component.status}</span></td>
                    <td>${component.symbolFile || '-'}</td>
                    <td>${component.footprintFile || '-'}</td>
                    <td>${component.modelFile || '-'}</td>
                    <td>${component.notes || '-'}</td>
                `;
                table.appendChild(row);
            });
        }
        
        function exportData(format, category = null) {
            let data = category ? componentData[category] : componentData;
            let filename = category ? `${category}_components` : 'all_components';
            
            if (format === 'csv') {
                exportToCSV(data, filename);
            } else if (format === 'json') {
                exportToJSON(data, filename);
            }
        }
        
        function exportToCSV(data, filename) {
            if (!data || (Array.isArray(data) && data.length === 0)) {
                alert('No data to export');
                return;
            }
            
            let csvContent = '';
            let components = Array.isArray(data) ? data : Object.values(data).flat();
            
            if (components.length === 0) {
                alert('No components to export');
                return;
            }
            
            // Headers
            const headers = Object.keys(components[0]);
            csvContent += headers.join(',') + '\\n';
            
            // Data rows
            components.forEach(component => {
                const row = headers.map(header => {
                    const value = component[header] || '';
                    return `"${value.toString().replace(/"/g, '""')}"`;
                });
                csvContent += row.join(',') + '\\n';
            });
            
            downloadFile(csvContent, `${filename}.csv`, 'text/csv');
        }
        
        function exportToJSON(data, filename) {
            const jsonContent = JSON.stringify(data, null, 2);
            downloadFile(jsonContent, `${filename}.json`, 'application/json');
        }
        
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
        
        function searchComponents() {
            const searchTerm = document.getElementById('globalSearch').value.toLowerCase().trim();
            const categoryFilter = document.getElementById('categoryFilter').value;
            
            if (!searchTerm) {
                alert('Please enter a search term');
                return;
            }
            
            // Search across all components or specific category
            let searchResults = [];
            const categoriesToSearch = categoryFilter ? [categoryFilter] : Object.keys(componentData);
            
            categoriesToSearch.forEach(category => {
                const components = componentData[category] || [];
                components.forEach(component => {
                    // Search in all text fields of the component
                    const searchableText = [
                        component.kinbenPN, component.value, component.voltage, component.current, 
                        component.power, component.tolerance, component.package, component.mounting,
                        component.temperature, component.manufacturer, component.manufacturerPN,
                        component.description, component.supplier, component.mouserPN, 
                        component.digikeyPN, component.status, component.notes
                    ].join(' ').toLowerCase();
                    
                    if (searchableText.includes(searchTerm)) {
                        searchResults.push({
                            ...component,
                            category: category,
                            categoryName: getCategoryDisplayName(category)
                        });
                    }
                });
            });
            
            displaySearchResults(searchResults, searchTerm);
        }
        
        function getCategoryDisplayName(category) {
            const categoryNames = {
                capacitors: 'Capacitors', resistors: 'Resistors', inductors: 'Inductors',
                diodes: 'Diodes', transistors: 'Transistors', ics: 'Integrated Circuits',
                connectors: 'Connectors', crystals: 'Crystals & Oscillators', fuses: 'Fuses',
                switches: 'Switches', relays: 'Relays', optocouplers: 'Optocouplers',
                sensors: 'Sensors', mechanical: 'Mechanical', hardware: 'Hardware',
                cables: 'Cables & Wires'
            };
            return categoryNames[category] || category;
        }
        
        function displaySearchResults(results, searchTerm) {
            // Show search results sheet
            showSearchResults();
            
            // Update search results table
            const tbody = document.querySelector('#search-results .search-results-table tbody');
            const resultsCount = document.getElementById('search-results-count');
            const searchTermDisplay = document.getElementById('search-term-display');
            
            resultsCount.textContent = results.length;
            searchTermDisplay.textContent = searchTerm;
            
            if (results.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; color: #666; padding: 20px;">No components found matching your search.</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            results.forEach(component => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${component.kinbenPN}</strong></td>
                    <td><span class="category-badge">${component.categoryName}</span></td>
                    <td>${highlightSearchTerm(component.value || '-', searchTerm)}</td>
                    <td>${highlightSearchTerm(component.manufacturer || '-', searchTerm)}</td>
                    <td>${highlightSearchTerm(component.manufacturerPN || '-', searchTerm)}</td>
                    <td>${highlightSearchTerm(component.description || '-', searchTerm)}</td>
                    <td><span class="status-${component.status.toLowerCase()}">${component.status}</span></td>
                    <td><button class="btn btn-primary btn-sm" onclick="viewComponent('${component.category}', '${component.kinbenPN}')">View</button></td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function highlightSearchTerm(text, searchTerm) {
            if (!text || !searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }
        
        function showSearchResults() {
            // Hide all sheets
            const sheets = document.querySelectorAll('.sheet');
            sheets.forEach(sheet => sheet.classList.remove('active'));
            
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show search results sheet
            document.getElementById('search-results').classList.add('active');
            
            // Highlight search tab if it exists, otherwise create visual indicator
            const searchTab = document.querySelector('[onclick="showSheet(\'search-results\')"]');
            if (searchTab) {
                searchTab.classList.add('active');
            }
        }
        
        function viewComponent(category, kinbenPN) {
            // Switch to the category sheet and highlight the component
            showSheet(category);
            
            // Find and highlight the component in the table
            setTimeout(() => {
                const table = document.querySelector(`#${category} .component-table`);
                if (table) {
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => {
                        const firstCell = row.querySelector('td');
                        if (firstCell && firstCell.textContent === kinbenPN) {
                            row.style.backgroundColor = '#fff3cd';
                            row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            
                            // Remove highlight after 3 seconds
                            setTimeout(() => {
                                row.style.backgroundColor = '';
                            }, 3000);
                        }
                    });
                }
            }, 100);
        }
        
        function clearSearch() {
            document.getElementById('globalSearch').value = '';
            document.getElementById('categoryFilter').value = '';
            showSheet('landing');
        }
        
        // Category page filtering system
        function filterCategoryComponents(category) {
            const filters = getCategoryFilters(category);
            const components = componentData[category] || [];
            const table = document.querySelector(`#${category} .component-table tbody`);
            const stats = document.querySelector(`#${category} .filter-stats`);
            
            let visibleCount = 0;
            let totalCount = components.length;
            
            if (totalCount === 0) {
                if (stats) stats.textContent = 'No components to filter';
                return;
            }
            
            // Filter components
            const filteredComponents = components.filter(component => {
                let matches = true;
                
                // Text search filter
                if (filters.search && filters.search.trim() !== '') {
                    const searchTerm = filters.search.toLowerCase();
                    const searchableText = [
                        component.kinbenPN, component.value, component.manufacturer, 
                        component.manufacturerPN, component.description, component.notes
                    ].join(' ').toLowerCase();
                    matches = matches && searchableText.includes(searchTerm);
                }
                
                // Manufacturer filter
                if (filters.manufacturer && filters.manufacturer !== '') {
                    matches = matches && (component.manufacturer || '').toLowerCase().includes(filters.manufacturer.toLowerCase());
                }
                
                // Status filter
                if (filters.status && filters.status !== '') {
                    matches = matches && (component.status || '').toLowerCase() === filters.status.toLowerCase();
                }
                
                // Package filter
                if (filters.package && filters.package !== '') {
                    matches = matches && (component.package || '').toLowerCase().includes(filters.package.toLowerCase());
                }
                
                // Mounting filter
                if (filters.mounting && filters.mounting !== '') {
                    matches = matches && (component.mounting || '').toLowerCase() === filters.mounting.toLowerCase();
                }
                
                return matches;
            });
            
            // Hide/show table rows
            const rows = table.querySelectorAll('tr');
            rows.forEach((row, index) => {
                if (index === 0 && row.textContent.includes('No components')) {
                    return; // Skip empty state row
                }
                
                const component = components[index];
                if (component && filteredComponents.includes(component)) {
                    row.classList.remove('hidden-row');
                    visibleCount++;
                } else if (component) {
                    row.classList.add('hidden-row');
                }
            });
            
            // Update stats
            if (stats) {
                stats.textContent = `Showing ${visibleCount} of ${totalCount} components`;
                if (visibleCount !== totalCount) {
                    stats.textContent += ` (${totalCount - visibleCount} filtered out)`;
                }
            }
            
            // Update active filters display
            updateActiveFilters(category, filters);
        }
        
        function getCategoryFilters(category) {
            const filterPrefix = `${category}-filter`;
            return {
                search: (document.getElementById(`${filterPrefix}-search`) || {}).value || '',
                manufacturer: (document.getElementById(`${filterPrefix}-manufacturer`) || {}).value || '',
                status: (document.getElementById(`${filterPrefix}-status`) || {}).value || '',
                package: (document.getElementById(`${filterPrefix}-package`) || {}).value || '',
                mounting: (document.getElementById(`${filterPrefix}-mounting`) || {}).value || ''
            };
        }
        
        function clearCategoryFilters(category) {
            const filterPrefix = `${category}-filter`;
            const filterIds = ['search', 'manufacturer', 'status', 'package', 'mounting'];
            
            filterIds.forEach(filterId => {
                const element = document.getElementById(`${filterPrefix}-${filterId}`);
                if (element) element.value = '';
            });
            
            // Clear active filters and refresh
            updateActiveFilters(category, {});
            refreshComponentTable(category);
        }
        
        function updateActiveFilters(category, filters) {
            const activeFiltersContainer = document.querySelector(`#${category} .active-filters`);
            if (!activeFiltersContainer) return;
            
            activeFiltersContainer.innerHTML = '';
            
            // Add filter badges for active filters
            Object.keys(filters).forEach(filterKey => {
                const filterValue = filters[filterKey];
                if (filterValue && filterValue.trim() !== '') {
                    const badge = document.createElement('div');
                    badge.className = 'filter-badge';
                    badge.innerHTML = `
                        <span>${filterKey}: ${filterValue}</span>
                        <span class="remove-filter" onclick="removeFilter('${category}', '${filterKey}')">&times;</span>
                    `;
                    activeFiltersContainer.appendChild(badge);
                }
            });
        }
        
        function removeFilter(category, filterKey) {
            const filterPrefix = `${category}-filter`;
            const element = document.getElementById(`${filterPrefix}-${filterKey}`);
            if (element) {
                element.value = '';
                filterCategoryComponents(category);
            }
        }
        
        function sortTable(category, columnIndex, dataType = 'string') {
            const table = document.querySelector(`#${category} .component-table`);
            const tbody = table.querySelector('tbody');
            const thead = table.querySelector('thead');
            const rows = Array.from(tbody.querySelectorAll('tr')).filter(row => 
                !row.textContent.includes('No components') && !row.classList.contains('hidden-row')
            );
            
            if (rows.length === 0) return;
            
            // Get current sort direction for this column
            const header = thead.querySelectorAll('th')[columnIndex];
            const currentDirection = header.dataset.sortDirection || 'asc';
            const newDirection = currentDirection === 'asc' ? 'desc' : 'asc';
            
            // Clear all sort indicators
            thead.querySelectorAll('th').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
                th.dataset.sortDirection = '';
            });
            
            // Set new sort direction and indicator
            header.dataset.sortDirection = newDirection;
            header.classList.add(`sort-${newDirection}`);
            
            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex]?.textContent.trim() || '';
                const bValue = b.cells[columnIndex]?.textContent.trim() || '';
                
                let comparison = 0;
                
                if (dataType === 'number') {
                    // Handle currency and numeric values
                    const aNum = parseFloat(aValue.replace(/[$,]/g, '')) || 0;
                    const bNum = parseFloat(bValue.replace(/[$,]/g, '')) || 0;
                    comparison = aNum - bNum;
                } else if (dataType === 'date') {
                    const aDate = new Date(aValue);
                    const bDate = new Date(bValue);
                    comparison = aDate - bDate;
                } else {
                    // String comparison (default)
                    comparison = aValue.localeCompare(bValue, undefined, { numeric: true, sensitivity: 'base' });
                }
                
                return newDirection === 'asc' ? comparison : -comparison;
            });
            
            // Reorder rows in DOM
            rows.forEach(row => tbody.appendChild(row));
        }
        
        // Make table headers sortable
        function makeSortableHeaders(category) {
            const table = document.querySelector(`#${category} .component-table`);
            if (!table) return;
            
            const headers = table.querySelectorAll('thead th');
            const columnConfig = {
                0: { type: 'string' },    // Kinben PN
                1: { type: 'string' },    // Value/Type
                2: { type: 'string' },    // Voltage/Frequency etc.
                3: { type: 'string' },    // Tolerance/Current etc.
                4: { type: 'string' },    // Package
                5: { type: 'string' },    // Mounting
                6: { type: 'string' },    // Temperature Range
                7: { type: 'string' },    // Manufacturer
                8: { type: 'string' },    // Manufacturer PN
                9: { type: 'string' },    // Description
                10: { type: 'string' },   // Preferred Supplier
                11: { type: 'string' },   // Mouser PN
                12: { type: 'string' },   // DigiKey PN
                13: { type: 'number' },   // Unit Cost
                14: { type: 'number' },   // MOQ
                15: { type: 'string' },   // Status
                16: { type: 'string' },   // Symbol File
                17: { type: 'string' },   // Footprint File
                18: { type: 'string' },   // 3D Model File
                19: { type: 'string' }    // Notes
            };
            
            headers.forEach((header, index) => {
                header.classList.add('sortable-header');
                header.style.cursor = 'pointer';
                header.title = 'Click to sort';
                
                const dataType = columnConfig[index]?.type || 'string';
                header.onclick = () => sortTable(category, index, dataType);
            });
        }
        
        // Generate filter HTML for a category
        function generateCategoryFilters(category, categoryDisplayName) {
            return `
                <!-- Category Filters -->
                <div class="category-filters">
                    <h4>🔍 Filter ${categoryDisplayName}</h4>
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>Search</label>
                            <input type="text" id="${category}-filter-search" class="filter-input" placeholder="Search ${categoryDisplayName.toLowerCase()}..." onkeyup="filterCategoryComponents('${category}')">
                        </div>
                        <div class="filter-group">
                            <label>Manufacturer</label>
                            <input type="text" id="${category}-filter-manufacturer" class="filter-input" placeholder="e.g. Murata, TI, Vishay..." onkeyup="filterCategoryComponents('${category}')">
                        </div>
                        <div class="filter-group">
                            <label>Status</label>
                            <select id="${category}-filter-status" class="filter-select" onchange="filterCategoryComponents('${category}')">
                                <option value="">All Status</option>
                                <option value="active">Active</option>
                                <option value="pending">Pending</option>
                                <option value="obsolete">Obsolete</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Package</label>
                            <input type="text" id="${category}-filter-package" class="filter-input" placeholder="e.g. 0603, SOT-23, TO-220..." onkeyup="filterCategoryComponents('${category}')">
                        </div>
                        <div class="filter-group">
                            <label>Mounting</label>
                            <select id="${category}-filter-mounting" class="filter-select" onchange="filterCategoryComponents('${category}')">
                                <option value="">All Mounting</option>
                                <option value="smd">SMD</option>
                                <option value="tht">Through Hole</option>
                                <option value="both">Both</option>
                            </select>
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-warning btn-sm" onclick="clearCategoryFilters('${category}')">🔄 Clear</button>
                        </div>
                    </div>
                    <div class="active-filters"></div>
                    <div class="filter-stats">Ready to filter components</div>
                </div>
            `;
        }
        
        // Initialize category filters on page load
        function initializeCategoryFilters() {
            const categories = [
                { id: 'capacitors', name: 'Capacitors' }, // Include capacitors since it has manual filters
                { id: 'resistors', name: 'Resistors' },
                { id: 'inductors', name: 'Inductors' },
                { id: 'diodes', name: 'Diodes' },
                { id: 'transistors', name: 'Transistors' },
                { id: 'ics', name: 'ICs' },
                { id: 'connectors', name: 'Connectors' },
                { id: 'crystals', name: 'Crystals' },
                { id: 'fuses', name: 'Fuses' },
                { id: 'switches', name: 'Switches' },
                { id: 'relays', name: 'Relays' },
                { id: 'optocouplers', name: 'Optocouplers' },
                { id: 'sensors', name: 'Sensors' },
                { id: 'mechanical', name: 'Mechanical' },
                { id: 'hardware', name: 'Hardware' },
                { id: 'cables', name: 'Cables' }
            ];
            
            categories.forEach(category => {
                const categorySheet = document.getElementById(category.id);
                if (categorySheet) {
                    const actionButtons = categorySheet.querySelector('.action-buttons');
                    const table = categorySheet.querySelector('.component-table');
                    
                    if (actionButtons && table) {
                        // Add filters if not already present
                        if (!categorySheet.querySelector('.category-filters')) {
                            const filtersHTML = generateCategoryFilters(category.id, category.name);
                            actionButtons.insertAdjacentHTML('afterend', filtersHTML);
                        }
                        
                        // Make table headers sortable
                        makeSortableHeaders(category.id);
                    }
                }
            });
        }
        
        // Initialize on page load
        window.addEventListener('load', function() {
            updateStats();
            initializeCategoryFilters(); // Add category filters to all pages
            initializeSystemManagement(); // Initialize system-first approach
            
            // Add event listeners
            document.getElementById('categorySelect').addEventListener('change', updateSubcategories);
            document.getElementById('subcategorySelect').addEventListener('change', generateKPNPreview);
            
            // Add Enter key support for search
            document.getElementById('globalSearch').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchComponents();
                }
            });
            
            // Close modal when clicking outside
            document.getElementById('addComponentModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAddComponentModal();
                }
            });
        });
    </script>
</head>
<body>
    <div class="workbook-container">
        <div class="sheet-tabs">
            <div class="tab active" onclick="showSheet('landing')">📊 Dashboard</div>
            <div class="tab" onclick="showSheet('systems')" style="border-left: 3px solid #28a745;">🏗️ SYSTEMS</div>
            <div class="tab" onclick="showSheet('assemblies')" style="border-left: 3px solid #28a745;">🔧 ASSEMBLIES</div>
            <div class="tab" onclick="showSheet('3d-parts')" style="border-left: 3px solid #28a745;">🖨️ 3D PARTS</div>
            <div class="tab" onclick="showSheet('cable-assemblies')" style="border-left: 3px solid #28a745;">🔗 CABLE ASSY</div>
            <div class="tab" onclick="showSheet('add-component')">➕ Add Component</div>
            <div class="tab" onclick="showSheet('capacitors')">🔋 CAPACITORS</div>
            <div class="tab" onclick="showSheet('resistors')">⚡ RESISTORS</div>
            <div class="tab" onclick="showSheet('inductors')">🌀 INDUCTORS</div>
            <div class="tab" onclick="showSheet('diodes')">💡 DIODES</div>
            <div class="tab" onclick="showSheet('transistors')">🔧 TRANSISTORS</div>
            <div class="tab" onclick="showSheet('ics')">🖥️ ICs</div>
            <div class="tab" onclick="showSheet('connectors')">🔌 CONNECTORS</div>
            <div class="tab" onclick="showSheet('crystals')">🔮 CRYSTALS</div>
            <div class="tab" onclick="showSheet('fuses')">🛡️ FUSES</div>
            <div class="tab" onclick="showSheet('switches')">🔘 SWITCHES</div>
            <div class="tab" onclick="showSheet('relays')">🔄 RELAYS</div>
            <div class="tab" onclick="showSheet('optocouplers')">💡 OPTOCOUPLERS</div>
            <div class="tab" onclick="showSheet('sensors')">📡 SENSORS</div>
            <div class="tab" onclick="showSheet('mechanical')">⚙️ MECHANICAL</div>
            <div class="tab" onclick="showSheet('hardware')">🔩 HARDWARE</div>
            <div class="tab" onclick="showSheet('cables')">🔌 CABLES</div>
        </div>

        <!-- Enhanced Dashboard -->
        <div id="landing" class="sheet active">
            <div class="landing-page">
                <div class="landing-title">🏗️ Kinben System Manager</div>
                <div class="landing-subtitle">Multi-Level System & Multiboard Management Platform</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-components">0</div>
                        <div class="stat-label">Total Components</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="active-categories">0</div>
                        <div class="stat-label">Active Categories</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-categories">16</div>
                        <div class="stat-label">Total Categories</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-systems">0</div>
                        <div class="stat-label">🏗️ Systems</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-assemblies">0</div>
                        <div class="stat-label">🔧 Assemblies</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-multiboard">0</div>
                        <div class="stat-label">📋 Multiboard Projects</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">📈</div>
                        <div class="stat-label">Growing Daily</div>
                    </div>
                </div>
                
                <div class="section-header" style="background: #28a745; color: white; padding: 15px; border-radius: 8px; margin: 20px 0; font-size: 18px; font-weight: bold; text-align: center;">🏗️ System Management - Multiboard Ordering</div>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="showSheet('systems')">🏗️ Manage Systems</button>
                    <button class="btn btn-primary" onclick="showSheet('assemblies')">🔧 Manage Assemblies</button>
                    <button class="btn btn-info" onclick="openAddSystemModal('systems')">➕ Create New System</button>
                    <button class="btn btn-warning" onclick="openMultiboardWizard()">📋 Multiboard Project Wizard</button>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="showSheet('add-component')">➕ Add Component</button>
                    <button class="btn btn-success" onclick="exportData('csv')">📄 Export All CSV</button>
                    <button class="btn btn-info" onclick="exportData('json')">📊 Export JSON</button>
                    <button class="btn btn-warning" onclick="document.getElementById('globalSearch').focus()">🔍 Advanced Search</button>
                </div>
                
                <div class="info-grid">
                    <div class="info-card">
                        <h3>📋 System Purpose</h3>
                        <p>Centralized management of Kinben Part Numbers (KPNs) with standardized naming conventions, component specifications, and library references.</p>
                    </div>
                    <div class="info-card">
                        <h3>🎯 New Features</h3>
                        <ul>
                            <li>✅ Interactive component addition</li>
                            <li>✅ Real-time statistics</li>
                            <li>✅ Export functionality</li>
                            <li>✅ Auto KPN generation</li>
                            <li>✅ Mobile responsive design</li>
                        </ul>
                    </div>
                </div>
                
                <div class="naming-convention">
                    <h3>🏷️ KPN Naming Convention</h3>
                    <p><strong>Format:</strong> KPN-[CATEGORY]-[SUBCATEGORY]-[SEQUENCE]</p>
                    <p><strong>Example:</strong> KPN-CAP-CER-00001 (Ceramic Capacitor #1)</p>
                </div>
            </div>
            
            <!-- Global Search -->
            <div class="search-controls">
                <input type="text" id="globalSearch" class="search-input" placeholder="Search all components...">
                <select id="categoryFilter" class="filter-select">
                    <option value="">All Categories</option>
                    <option value="capacitors">Capacitors</option>
                    <option value="resistors">Resistors</option>
                    <option value="inductors">Inductors</option>
                    <option value="diodes">Diodes</option>
                    <option value="transistors">Transistors</option>
                    <option value="ics">Integrated Circuits</option>
                    <option value="connectors">Connectors</option>
                    <option value="crystals">Crystals & Oscillators</option>
                    <option value="fuses">Fuses</option>
                    <option value="switches">Switches</option>
                    <option value="relays">Relays</option>
                    <option value="optocouplers">Optocouplers</option>
                    <option value="sensors">Sensors</option>
                    <option value="mechanical">Mechanical</option>
                    <option value="hardware">Hardware</option>
                    <option value="cables">Cables & Wires</option>
                </select>
                <button class="btn btn-primary" onclick="searchComponents()">🔍 Search</button>
            </div>
            
            <div class="section-header">📊 Component Categories</div>
            <table class="category-table">
                <tr>
                    <th>Category Code</th>
                    <th>Category Name</th>
                    <th>Subcategories</th>
                    <th>Total Parts</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
                <tr data-category="capacitors">
                    <td>CAP</td><td>Capacitors</td><td>CER, ELE, TAN, FIL</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('capacitors')">Add</button></td>
                </tr>
                <tr data-category="resistors">
                    <td>RES</td><td>Resistors</td><td>STD, PRE, VAR, NET</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('resistors')">Add</button></td>
                </tr>
                <tr data-category="inductors">
                    <td>IND</td><td>Inductors</td><td>PWR, CHK, FER</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('inductors')">Add</button></td>
                </tr>
                <tr data-category="diodes">
                    <td>DIO</td><td>Diodes</td><td>STD, LED, ZEN, SCH</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('diodes')">Add</button></td>
                </tr>
                <tr data-category="transistors">
                    <td>TRA</td><td>Transistors</td><td>BJT, FET, MOS</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('transistors')">Add</button></td>
                </tr>
                <tr data-category="ics">
                    <td>IC</td><td>Integrated Circuits</td><td>MCU, ANA, DIG, PWR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('ics')">Add</button></td>
                </tr>
                <tr data-category="connectors">
                    <td>CON</td><td>Connectors</td><td>HDR, JST, USB, RJ45</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('connectors')">Add</button></td>
                </tr>
                <tr data-category="crystals">
                    <td>CRY</td><td>Crystals & Oscillators</td><td>XTL, OSC, RES</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('crystals')">Add</button></td>
                </tr>
                <tr data-category="fuses">
                    <td>FUS</td><td>Fuses</td><td>STD, RST, PTC</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('fuses')">Add</button></td>
                </tr>
                <tr data-category="switches">
                    <td>SWI</td><td>Switches</td><td>TAC, DIP, ROT, SLI</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('switches')">Add</button></td>
                </tr>
                <tr data-category="relays">
                    <td>REL</td><td>Relays</td><td>EMR, SSR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('relays')">Add</button></td>
                </tr>
                <tr data-category="optocouplers">
                    <td>OPT</td><td>Optocouplers</td><td>STD, HIS, DAR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('optocouplers')">Add</button></td>
                </tr>
                <tr data-category="sensors">
                    <td>SEN</td><td>Sensors</td><td>TMP, PRE, ACC, GYR</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('sensors')">Add</button></td>
                </tr>
                <tr data-category="mechanical">
                    <td>MEC</td><td>Mechanical</td><td>ENC, FAN, HEA, SPK</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('mechanical')">Add</button></td>
                </tr>
                <tr data-category="hardware">
                    <td>HWR</td><td>Hardware</td><td>SCR, NUT, WSH, SPC</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('hardware')">Add</button></td>
                </tr>
                <tr data-category="cables">
                    <td>CBL</td><td>Cables & Wires</td><td>PWR, SIG, COA, FFC</td>
                    <td class="count-cell">0</td><td class="status-active">ACTIVE</td>
                    <td><button class="btn btn-primary" onclick="openAddComponentModal('cables')">Add</button></td>
                </tr>
            </table>
        </div>

        <!-- Add Component Sheet -->
        <div id="add-component" class="sheet">
            <div class="section-header">➕ Add New Component</div>
            <div class="add-component-form">
                <h3>Component Information</h3>
                <form id="addComponentForm" onsubmit="event.preventDefault(); addComponent();">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="categorySelect">Category *</label>
                            <select id="categorySelect" name="category" required>
                                <option value="">Select Category</option>
                                <option value="capacitors">Capacitors</option>
                                <option value="resistors">Resistors</option>
                                <option value="inductors">Inductors</option>
                                <option value="diodes">Diodes</option>
                                <option value="transistors">Transistors</option>
                                <option value="ics">Integrated Circuits</option>
                                <option value="connectors">Connectors</option>
                                <option value="crystals">Crystals & Oscillators</option>
                                <option value="fuses">Fuses</option>
                                <option value="switches">Switches</option>
                                <option value="relays">Relays</option>
                                <option value="optocouplers">Optocouplers</option>
                                <option value="sensors">Sensors</option>
                                <option value="mechanical">Mechanical</option>
                                <option value="hardware">Hardware</option>
                                <option value="cables">Cables & Wires</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="subcategorySelect">Subcategory *</label>
                            <select id="subcategorySelect" name="subcategory" required>
                                <option value="">Select Subcategory</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="kinbenPN">Kinben PN (Auto-generated)</label>
                            <input type="text" id="kinbenPN" name="kinbenPN" readonly style="background: #f0f0f0;">
                            <small id="kpnPreview" style="color: #666;">Select category and subcategory</small>
                        </div>
                        <div class="form-group">
                            <label for="value">Value</label>
                            <input type="text" id="value" name="value" placeholder="e.g., 100nF, 1kΩ, 10µH">
                        </div>
                        <div class="form-group">
                            <label for="voltage">Voltage Rating</label>
                            <input type="text" id="voltage" name="voltage" placeholder="e.g., 50V, 3.3V">
                        </div>
                        <div class="form-group">
                            <label for="current">Current Rating</label>
                            <input type="text" id="current" name="current" placeholder="e.g., 1A, 500mA">
                        </div>
                        <div class="form-group">
                            <label for="power">Power Rating</label>
                            <input type="text" id="power" name="power" placeholder="e.g., 0.25W, 1W">
                        </div>
                        <div class="form-group">
                            <label for="tolerance">Tolerance</label>
                            <input type="text" id="tolerance" name="tolerance" placeholder="e.g., ±5%, ±1%">
                        </div>
                        <div class="form-group">
                            <label for="package">Package</label>
                            <input type="text" id="package" name="package" placeholder="e.g., 0603, SOIC-8, TO-220">
                        </div>
                        <div class="form-group">
                            <label for="mounting">Mounting</label>
                            <select id="mounting" name="mounting">
                                <option value="">Select</option>
                                <option value="SMD">SMD</option>
                                <option value="THT">Through Hole</option>
                                <option value="Both">Both</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="temperature">Temperature Range</label>
                            <input type="text" id="temperature" name="temperature" placeholder="e.g., -40°C to +85°C">
                        </div>
                        <div class="form-group">
                            <label for="manufacturer">Manufacturer</label>
                            <input type="text" id="manufacturer" name="manufacturer" placeholder="e.g., Murata, TI, Vishay">
                        </div>
                        <div class="form-group">
                            <label for="manufacturerPN">Manufacturer PN</label>
                            <input type="text" id="manufacturerPN" name="manufacturerPN" placeholder="Manufacturer part number">
                        </div>
                        <div class="form-group">
                            <label for="supplier">Preferred Supplier</label>
                            <select id="supplier" name="supplier">
                                <option value="">Select</option>
                                <option value="Mouser">Mouser</option>
                                <option value="DigiKey">DigiKey</option>
                                <option value="FIDES">FIDES</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="mouserPN">Mouser PN</label>
                            <input type="text" id="mouserPN" name="mouserPN" placeholder="Mouser part number">
                        </div>
                        <div class="form-group">
                            <label for="digikeyPN">DigiKey PN</label>
                            <input type="text" id="digikeyPN" name="digikeyPN" placeholder="DigiKey part number">
                        </div>
                        <div class="form-group">
                            <label for="cost">Unit Cost (USD)</label>
                            <input type="number" id="cost" name="cost" step="0.01" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label for="moq">MOQ</label>
                            <input type="number" id="moq" name="moq" placeholder="Minimum order quantity">
                        </div>
                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status">
                                <option value="Active">Active</option>
                                <option value="Pending">Pending</option>
                                <option value="Obsolete">Obsolete</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="symbolFile">Symbol File</label>
                            <input type="text" id="symbolFile" name="symbolFile" placeholder="KiCad symbol filename">
                        </div>
                        <div class="form-group">
                            <label for="footprintFile">Footprint File</label>
                            <input type="text" id="footprintFile" name="footprintFile" placeholder="KiCad footprint filename">
                        </div>
                        <div class="form-group">
                            <label for="modelFile">3D Model File</label>
                            <input type="text" id="modelFile" name="modelFile" placeholder="3D model filename">
                        </div>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" placeholder="Detailed component description"></textarea>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label for="notes">Notes</label>
                        <textarea id="notes" name="notes" placeholder="Additional notes, special requirements, etc."></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-success">✅ Add Component</button>
                        <button type="reset" class="btn btn-warning">🔄 Reset Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Component Category Sheets (Enhanced) -->
        <div id="capacitors" class="sheet">
            <div class="section-header">🔋 CAPACITORS - Category Code: CAP</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('capacitors')">➕ Add Capacitor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'capacitors')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportData('json', 'capacitors')">📊 Export JSON</button>
            </div>
            
            <!-- Category Filters -->
            <div class="category-filters">
                <h4>🔍 Filter Capacitors</h4>
                <div class="filter-grid">
                    <div class="filter-group">
                        <label>Search</label>
                        <input type="text" id="capacitors-filter-search" class="filter-input" placeholder="Search capacitors..." onkeyup="filterCategoryComponents('capacitors')">
                    </div>
                    <div class="filter-group">
                        <label>Manufacturer</label>
                        <input type="text" id="capacitors-filter-manufacturer" class="filter-input" placeholder="e.g. Murata, Samsung..." onkeyup="filterCategoryComponents('capacitors')">
                    </div>
                    <div class="filter-group">
                        <label>Status</label>
                        <select id="capacitors-filter-status" class="filter-select" onchange="filterCategoryComponents('capacitors')">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="pending">Pending</option>
                            <option value="obsolete">Obsolete</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Package</label>
                        <input type="text" id="capacitors-filter-package" class="filter-input" placeholder="e.g. 0603, 0805..." onkeyup="filterCategoryComponents('capacitors')">
                    </div>
                    <div class="filter-group">
                        <label>Mounting</label>
                        <select id="capacitors-filter-mounting" class="filter-select" onchange="filterCategoryComponents('capacitors')">
                            <option value="">All Mounting</option>
                            <option value="smd">SMD</option>
                            <option value="tht">Through Hole</option>
                            <option value="both">Both</option>
                        </select>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-warning btn-sm" onclick="clearCategoryFilters('capacitors')">🔄 Clear</button>
                    </div>
                </div>
                <div class="active-filters"></div>
                <div class="filter-stats">Ready to filter components</div>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th>Kinben PN</th><th>Value</th><th>Voltage Rating</th><th>Tolerance</th><th>Package</th>
                        <th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th>
                        <th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th>
                        <th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th>
                        <th>3D Model File</th><th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Capacitor" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <div id="resistors" class="sheet">
            <div class="section-header">⚡ RESISTORS - Category Code: RES</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('resistors')">➕ Add Resistor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'resistors')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportData('json', 'resistors')">📊 Export JSON</button>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th>Kinben PN</th><th>Value</th><th>Power Rating</th><th>Tolerance</th><th>Package</th>
                        <th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th>
                        <th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th>
                        <th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th>
                        <th>3D Model File</th><th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Resistor" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Add similar structure for other categories -->
        <div id="inductors" class="sheet">
            <div class="section-header">🌀 INDUCTORS - Category Code: IND</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('inductors')">➕ Add Inductor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'inductors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Value</th><th>Current Rating</th><th>DCR</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Inductor" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="diodes" class="sheet">
            <div class="section-header">💡 DIODES - Category Code: DIO</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('diodes')">➕ Add Diode</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'diodes')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Voltage Rating</th><th>Current Rating</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Diode" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="transistors" class="sheet">
            <div class="section-header">🔧 TRANSISTORS - Category Code: TRA</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('transistors')">➕ Add Transistor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'transistors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Voltage Rating</th><th>Current Rating</th><th>Power Rating</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Transistor" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="ics" class="sheet">
            <div class="section-header">🖥️ INTEGRATED CIRCUITS - Category Code: IC</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('ics')">➕ Add IC</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'ics')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Voltage Rating</th><th>Current Rating</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Pin Count</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add IC" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="connectors" class="sheet">
            <div class="section-header">🔌 CONNECTORS - Category Code: CON</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('connectors')">➕ Add Connector</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'connectors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Positions</th><th>Current Rating</th><th>Voltage Rating</th><th>Pitch</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Connector" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="crystals" class="sheet">
            <div class="section-header">🔮 CRYSTALS & OSCILLATORS - Category Code: CRY</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('crystals')">➕ Add Crystal/Oscillator</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'crystals')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Frequency</th><th>Tolerance</th><th>Load Capacitance</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Crystal/Oscillator" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="fuses" class="sheet">
            <div class="section-header">🛡️ FUSES - Category Code: FUS</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('fuses')">➕ Add Fuse</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'fuses')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Current Rating</th><th>Voltage Rating</th><th>Type</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Fuse" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="switches" class="sheet">
            <div class="section-header">🔘 SWITCHES - Category Code: SWI</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('switches')">➕ Add Switch</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'switches')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Current Rating</th><th>Voltage Rating</th><th>Actuator Type</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Switch" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="relays" class="sheet">
            <div class="section-header">🔄 RELAYS - Category Code: REL</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('relays')">➕ Add Relay</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'relays')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Coil Voltage</th><th>Contact Rating</th><th>Contact Config</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Relay" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="optocouplers" class="sheet">
            <div class="section-header">💡 OPTOCOUPLERS - Category Code: OPT</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('optocouplers')">➕ Add Optocoupler</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'optocouplers')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>CTR</th><th>Isolation Voltage</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Optocoupler" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="sensors" class="sheet">
            <div class="section-header">📡 SENSORS - Category Code: SEN</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('sensors')">➕ Add Sensor</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'sensors')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Range</th><th>Accuracy</th><th>Supply Voltage</th><th>Package</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Sensor" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="mechanical" class="sheet">
            <div class="section-header">⚙️ MECHANICAL - Category Code: MEC</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('mechanical')">➕ Add Mechanical Component</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'mechanical')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Specifications</th><th>Material</th><th>Dimensions</th><th>Mounting</th><th>Temperature Range</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Mechanical Component" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="hardware" class="sheet">
            <div class="section-header">🔩 HARDWARE - Category Code: HWR</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('hardware')">➕ Add Hardware</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'hardware')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>Size</th><th>Material</th><th>Finish</th><th>Thread Type</th><th>Length</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>MOQ</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Hardware" to get started!</td></tr></tbody>
            </table>
        </div>

        <div id="cables" class="sheet">
            <div class="section-header">🔌 CABLES & WIRES - Category Code: CBL</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddComponentModal('cables')">➕ Add Cable/Wire</button>
                <button class="btn btn-success export-button" onclick="exportData('csv', 'cables')">📄 Export CSV</button>
            </div>
            <table class="component-table">
                <thead><tr><th>Kinben PN</th><th>Type</th><th>AWG/Size</th><th>Length</th><th>Connector A</th><th>Connector B</th><th>Shielding</th><th>Color</th><th>Manufacturer</th><th>Manufacturer PN</th><th>Description</th><th>Preferred Supplier</th><th>Mouser PN</th><th>DigiKey PN</th><th>Unit Cost</th><th>Status</th><th>Symbol File</th><th>Footprint File</th><th>3D Model File</th><th>Notes</th></tr></thead>
                <tbody><tr><td colspan="20" style="text-align: center; color: #666; padding: 20px;">No components added yet. Click "Add Cable/Wire" to get started!</td></tr></tbody>
            </table>
        </div>

        <!-- Search Results Sheet -->
        <div id="search-results" class="sheet">
            <div class="section-header">🔍 Search Results</div>
            <div class="search-results-header">
                <div class="search-results-info">
                    <h3>Found <span id="search-results-count">0</span> results for "<span id="search-term-display">-</span>"</h3>
                </div>
                <div class="search-results-actions">
                    <button class="btn btn-success" onclick="exportData('csv', null)" title="Export search results">📄 Export CSV</button>
                    <button class="btn btn-warning" onclick="clearSearch()">🔄 New Search</button>
                    <button class="btn btn-primary" onclick="showSheet('landing')">📊 Back to Dashboard</button>
                </div>
            </div>
            
            <table class="search-results-table">
                <thead>
                    <tr>
                        <th>Kinben PN</th>
                        <th>Category</th>
                        <th>Value</th>
                        <th>Manufacturer</th>
                        <th>Manufacturer PN</th>
                        <th>Description</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="8" style="text-align: center; color: #666; padding: 20px;">Use the search function above to find components across all categories.</td></tr>
                </tbody>
            </table>
        </div>

        <!-- SYSTEMS Management Sheet -->
        <div id="systems" class="sheet">
            <div class="section-header">🏗️ SYSTEMS - Complete Products & Projects (SKN)</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddSystemModal('systems')">➕ Add System</button>
                <button class="btn btn-success export-button" onclick="exportSystemData('csv', 'systems')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportSystemData('json', 'systems')">📄 Export JSON</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="systems-count">0</div>
                    <div class="stat-label">Total Systems</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="systems-active">0</div>
                    <div class="stat-label">Active Systems</div>
                </div>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'systemKN')">System KN</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'name')">System Name</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'version')">Version</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'type')">Type</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'status')">Status</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'assemblies')">Assemblies</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'description')">Description</th>
                        <th class="sortable-header" onclick="sortSystemTable('systems', 'owner')">Owner</th>
                        <th>Documentation</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="10" style="text-align: center; color: #666; padding: 20px;">No systems added yet. Click "Add System" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <!-- ASSEMBLIES Management Sheet -->
        <div id="assemblies" class="sheet">
            <div class="section-header">🔧 ASSEMBLIES - PCBAs & Mechanical Assemblies (AKN)</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddSystemModal('assemblies')">➕ Add Assembly</button>
                <button class="btn btn-success export-button" onclick="exportSystemData('csv', 'assemblies')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportSystemData('json', 'assemblies')">📄 Export JSON</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="assemblies-count">0</div>
                    <div class="stat-label">Total Assemblies</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="assemblies-active">0</div>
                    <div class="stat-label">Active Assemblies</div>
                </div>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'assemblyKN')">Assembly KN</th>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'name')">Assembly Name</th>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'type')">Type</th>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'version')">Version</th>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'status')">Status</th>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'components')">Components</th>
                        <th class="sortable-header" onclick="sortSystemTable('assemblies', 'description')">Description</th>
                        <th>Files</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="9" style="text-align: center; color: #666; padding: 20px;">No assemblies added yet. Click "Add Assembly" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <!-- 3D PARTS Management Sheet -->
        <div id="3d-parts" class="sheet">
            <div class="section-header">🖨️ 3D PRINTED PARTS - Custom 3D Components (3PN)</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddSystemModal('3d-parts')">➕ Add 3D Part</button>
                <button class="btn btn-success export-button" onclick="exportSystemData('csv', '3d-parts')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportSystemData('json', '3d-parts')">📄 Export JSON</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="3d-parts-count">0</div>
                    <div class="stat-label">Total 3D Parts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="3d-parts-active">0</div>
                    <div class="stat-label">Active 3D Parts</div>
                </div>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'partKN')">3D Part KN</th>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'name')">Part Name</th>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'type')">Type</th>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'material')">Material</th>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'status')">Status</th>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'version')">Version</th>
                        <th class="sortable-header" onclick="sortSystemTable('3d-parts', 'description')">Description</th>
                        <th>STL/CAD Files</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="9" style="text-align: center; color: #666; padding: 20px;">No 3D parts added yet. Click "Add 3D Part" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <!-- CABLE ASSEMBLIES Management Sheet -->
        <div id="cable-assemblies" class="sheet">
            <div class="section-header">🔗 CABLE ASSEMBLIES - Custom Cable Harnesses (CAN)</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddSystemModal('cable-assemblies')">➕ Add Cable Assembly</button>
                <button class="btn btn-success export-button" onclick="exportSystemData('csv', 'cable-assemblies')">📄 Export CSV</button>
                <button class="btn btn-info export-button" onclick="exportSystemData('json', 'cable-assemblies')">📄 Export JSON</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="cable-assemblies-count">0</div>
                    <div class="stat-label">Total Cable Assemblies</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="cable-assemblies-active">0</div>
                    <div class="stat-label">Active Cable Assemblies</div>
                </div>
            </div>
            <table class="component-table">
                <thead>
                    <tr>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'cableKN')">Cable KN</th>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'name')">Cable Name</th>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'type')">Type</th>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'length')">Length</th>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'connectors')">Connectors</th>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'status')">Status</th>
                        <th class="sortable-header" onclick="sortSystemTable('cable-assemblies', 'description')">Description</th>
                        <th>Diagram</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="9" style="text-align: center; color: #666; padding: 20px;">No cable assemblies added yet. Click "Add Cable Assembly" to get started!</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Add Component Modal -->
        <div id="addComponentModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeAddComponentModal()">&times;</span>
                <h2>Add New Component</h2>
                <p>This modal provides an alternative way to add components. Use the dedicated "Add Component" sheet for a better experience.</p>
                <button class="btn btn-primary" onclick="closeAddComponentModal(); showSheet('add-component')">Go to Add Component Sheet</button>
            </div>
        </div>
    </div>
</body>
</html>